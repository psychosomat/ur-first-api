# **Cap√≠tulo 1.4: Estrutura da API REST**
**Tempo de estudo:** 45 minutos

---

#### **1. API REST: Arquitetura da esta√ß√£o espacial**
Imagine uma esta√ß√£o espacial, onde cada m√≥dulo tem:

- **Porta de acoplamento padr√£o** (interface √∫nica)

- **Especializa√ß√£o clara** (compartimento de habita√ß√£o, laborat√≥rio, armazenamento)

- **Sistema de coordenadas** (localiza√ß√£o precisa)

A API **REST (Representational State Transfer)** funciona com os mesmos princ√≠pios:

- Interface √∫nica para todos os recursos

- Separa√ß√£o clara de componentes

- Endere√ßamento via URI (coordenadas espaciais)

> üí° **Ideia chave:**

> Cada recurso (planetas, foguetes, astronautas) tem um URL √∫nico e interage atrav√©s de m√©todos HTTP.

---

#### **2. 6 princ√≠pios REST na analogia espacial**
| Princ√≠pio REST          | An√°logo na ISS                   | Significado para a API             |
|-----------------------|----------------------------------|------------------------------------|
| **Interface √∫nica**   | N√≥s de acoplamento padr√£o        | Regras id√™nticas para todas as requisi√ß√µes |
| **Stateless**         | Cada comando √© autossuficiente   | O servidor n√£o armazena o estado do cliente |
| **Cache**             | Reservas locais de provis√µes     | Armazenamento de respostas frequentes |
| **Cliente-servidor**  | Separa√ß√£o clara: MCC ‚Üî Esta√ß√£o   | Desenvolvimento independente de componentes |
| **Multicamadas**      | Sat√©lites retransmissores        | Proxies, balanceadores de carga    |
| **C√≥digo sob demanda**| Download de software para experimentos | (Opcional) Transmiss√£o de scripts  |

---

#### **3. Recursos e URI: Coordenadas espaciais**
Cada objeto na API √© um recurso com um endere√ßo √∫nico:
```
https://api.spacexdata.com/v4/    ‚Üê URL Base
          rockets/            ‚Üê Cole√ß√£o de foguetes
          rockets/5e9d0d95eda69973a809d1ec ‚Üê Foguete espec√≠fico (por ID)
```

**Exemplos de recursos espaciais:**

- `GET /stars` ‚Üí Lista de estrelas
- `GET /stars/sirius` ‚Üí Dados sobre S√≠rius
- `POST /satellites` ‚Üí Lan√ßar um novo sat√©lite
- `PUT /missions/artemis` ‚Üí Atualizar miss√£o

**Esquema de hierarquia URI:**
```
[URL Base]
‚îú‚îÄ‚îÄ /planets          ‚Üí Cole√ß√£o de planetas
‚îÇ   ‚îú‚îÄ‚îÄ /mars         ‚Üí Recurso "Marte"
‚îÇ   ‚îî‚îÄ‚îÄ /venus        ‚Üí Recurso "V√™nus"
‚îî‚îÄ‚îÄ /launches         ‚Üí Cole√ß√£o de lan√ßamentos
    ‚îú‚îÄ‚îÄ /upcoming     ‚Üí Subcole√ß√£o
    ‚îî‚îÄ‚îÄ /latest       ‚Üí Recurso
```

---

#### **4. Opera√ß√µes CRUD via m√©todos HTTP**
| Opera√ß√£o | M√©todo HTTP | Exemplo (Esta√ß√£o espacial)       | Resposta do servidor |
|----------|-------------|----------------------------------|--------------------|
| **Create** | `POST`    | Enviar novo m√≥dulo               | `201 Created`      |
| **Read**   | `GET`     | Solicitar dados sobre o m√≥dulo   | `200 OK`           |
| **Update** | `PUT`     | Reconfigurar m√≥dulo              | `200 OK`           |
| **Delete** | `DELETE`  | Desacoplar m√≥dulo antigo         | `204 No Content`   |

**‚ö° Exemplo de c√≥digo (Adicionar sat√©lite):**
```python
import requests

# Usamos um servi√ßo de teste que simula a cria√ß√£o de um recurso
new_post = {
    "title": "New Telescope Launch",
    "body": "Hubble-2 is ready for deployment.",
    "userId": 1
}

# Chave API condicional para demonstra√ß√£o de cabe√ßalhos
headers = {
    "Authorization": "Bearer YOUR_DEMO_KEY",
    "Content-Type": "application/json; charset=UTF-8"
}

response = requests.post(
    "https://jsonplaceholder.typicode.com/posts",
    json=new_post,
    headers=headers
)

if response.status_code == 201:
    print("‚úÖ Postagem sobre o novo sat√©lite criada com sucesso!")
    print("Resposta do servidor:")
    print(response.json())
else:
    print(f"‚ùå Erro! Status: {response.status_code}")
```

---

#### **5. Versionamento da API: Evolu√ß√£o da esta√ß√£o**
Assim como a ISS √© atualizada (M√≥dulo "Zarya" ‚Üí "Nauka"), a API muda de vers√£o:

- No URL: `https://api.spacex.com/v4/rockets`
- Nos cabe√ßalhos: `Accept: application/vnd.spacex-v5+json`

**Por que √© importante:**

- v1: Funcionalidade b√°sica
- v2: Novos campos adicionados
- v3: Estrutura das respostas alterada

> ‚ö†Ô∏è **Dica:** Sempre especifique a vers√£o nas requisi√ß√µes, caso contr√°rio, a "acoplagem" pode falhar!

---

#### **6. Hiperm√≠dia (HATEOAS): Navega√ß√£o no espa√ßo**
A resposta da API cont√©m links para recursos relacionados ‚Äî como um mapa da esta√ß√£o:
```json
{
  "id": "iss",
  "name": "Esta√ß√£o Espacial Internacional",
  "crew": 7,
  "_links": {
    "self": { "href": "/stations/iss" },
    "modules": { "href": "/stations/iss/modules" },
    "schedule": { "href": "/stations/iss/schedule" }
  }
}
```

---

**Quiz para fixa√ß√£o**


<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. REST significa:</p>
      <label><input type="radio" name="q1" value="a"> a) Rocket Engine System Transfer</label>
      <label><input type="radio" name="q1" value="b"> b) Representational State Transfer</label>
      <label><input type="radio" name="q1" value="c"> c) Remote Space Technology</label>
    </div>
    <div class="question">
      <p>2. O princ√≠pio "Stateless" significa:</p>
      <label><input type="radio" name="q2" value="a"> a) O servidor armazena o hist√≥rico de requisi√ß√µes</label>
      <label><input type="radio" name="q2" value="b"> b) Cada requisi√ß√£o √© autossuficiente</label>
      <label><input type="radio" name="q2" value="c"> c) Os dados s√£o transmitidos apenas via SSL</label>
    </div>
    <div class="question">
      <p>3. URI para obter dados sobre o foguete Falcon Heavy:</p>
      <label><input type="radio" name="q3" value="a"> a) POST /rockets/falcon-heavy</label>
      <label><input type="radio" name="q3" value="b"> b) GET /falcon-heavy</label>
      <label><input type="radio" name="q3" value="c"> c) GET /rockets/falcon-heavy</label>
    </div>
    <div class="question">
      <p>4. M√©todo para atualiza√ß√£o completa de um recurso:</p>
      <label><input type="radio" name="q4" value="a"> a) PATCH</label>
      <label><input type="radio" name="q4" value="b"> b) POST</label>
      <label><input type="radio" name="q4" value="c"> c) PUT</label>
    </div>
    <div class="question">
      <p>5. HATEOAS na API √©:</p>
      <label><input type="radio" name="q5" value="a"> a) Um sistema de links para recursos relacionados</label>
      <label><input type="radio" name="q5" value="b"> b) Um protocolo de criptografia</label>
      <label><input type="radio" name="q5" value="c"> c) Uma linguagem de consulta</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Verificar</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'c', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Resultados:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:green;">Correto!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:red;">Incorreto.</span> Resposta correta: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:orange;">Sem resposta.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Seu resultado: ${score} de ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**üöÄ Conclus√£o do cap√≠tulo:**

A API REST √© uma "arquitetura de esta√ß√£o espacial" padronizada para servi√ßos web. Lembre-se:

- Recursos = Objetos (foguetes, planetas)
- URI = Coordenadas de objetos
- M√©todos HTTP = Comandos de controle
- Vers√µes = Moderniza√ß√µes da esta√ß√£o

**Final da prepara√ß√£o!** No pr√≥ximo cap√≠tulo, lan√ßaremos uma "sonda de teste" ‚Äî aprenderemos a testar APIs via Postman.

> **üìå Pr√°tica:**
Estude a estrutura da [API SpaceX](https://docs.spacexdata.com/) e tente executar:

> `GET https://api.spacexdata.com/v4/launches/latest` ‚Äî observe o URI e a estrutura JSON!