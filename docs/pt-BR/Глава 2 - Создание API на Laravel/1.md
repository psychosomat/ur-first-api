# **Cap√≠tulo 2.1: Preparando o Ambiente Laravel**
**Tempo de Estudo:** 1-2 horas
---

#### **1. Por que um Ambiente Local √© Necess√°rio?**
Imagine que voc√™ est√° construindo uma sonda espacial. Antes de lan√ß√°-la no espa√ßo, voc√™ **testa todos os sistemas na Terra**. Um ambiente local √© o seu "laborat√≥rio de controle" para o c√≥digo:

- Experimentos seguros sem impacto no servidor de produ√ß√£o
- Implanta√ß√£o r√°pida de depend√™ncias
- F√°cil altern√¢ncia entre vers√µes de software

> üí° **Analogia Espacial:**
> Herd = Complexo de Lan√ßamento M√≥vel
> Docker = Simulador de Esta√ß√£o Espacial
> XAMPP = Banco de Testes Estacion√°rio

---

#### **2. Instala√ß√£o do Herd**
**Herd** ‚Äî uma ferramenta moderna para gerenciar o ambiente PHP (an√°logo ao Laravel Valet).

**Passos de Instala√ß√£o:**

1. Baixe o instalador: [herd.laravel.com](https://herd.laravel.com)
2. Execute `Herd Installer.exe` ‚Üí Next ‚Üí Install
3. Ap√≥s a instala√ß√£o:
   	- Abra o Herd no menu Iniciar. O √≠cone do aplicativo aparecer√° na bandeja do sistema (perto do rel√≥gio).
   	- Clique no √≠cone do Herd: certifique-se de que o Nginx e a vers√£o de PHP desejada (por exemplo, 8.3) estejam em execu√ß√£o (marcados com um ponto verde).
   	- V√° para Herd Paths e adicione a pasta onde seus projetos ser√£o armazenados (por exemplo, C:\Users\YourUser\Code). O Herd criar√° automaticamente um dom√≠nio bonito do tipo nome-da-pasta.test para cada subdiret√≥rio nesta pasta.

> ‚ö†Ô∏è **Importante!** Durante a instala√ß√£o:
> - Permita o acesso √† rede (se o firewall solicitar)
> - Verifique o caminho no PATH: `C:\Program Files\Herd\bin`

**Verifica√ß√£o de Opera√ß√£o:**

1. Clique no √≠cone do Herd na bandeja do sistema.
2. Certifique-se de que os servi√ßos Nginx e PHP estejam ativos (indicadores verdes).
3. Na sua pasta de projetos (por exemplo, C:\Users\YourUser\Code), crie uma pasta test e dentro dela um arquivo index.php com o conte√∫do ```<?php phpinfo(); ?>```.
4. No Herd, atrav√©s da aba "sites", especifique o caminho para a pasta test e clique em "Add site".
5. Abra o endere√ßo http://test.test no navegador. Voc√™ dever√° ver a p√°gina com informa√ß√µes sobre o PHP.

---

#### **3. M√©todos Alternativos (brevemente)**
| Ferramenta       | Para quem             | Pr√≥s                                      | Contras                                           |
|------------------|-----------------------|-------------------------------------------|---------------------------------------------------|
| **Laravel Sail (Docker)**       | Para todos os n√≠veis  | Isolamento completo, repetibilidade do ambiente, suporte oficial do Laravel | Requer instala√ß√£o do Docker, consome mais recursos   |
| **XAMPP**        | Iniciantes           | Tudo em um instalador (All-in-One)        | Volumoso, mais dif√≠cil de gerenciar vers√µes de software, polui o sistema   |
| **Laragon**      | Desenvolvedores Windows | R√°pido, f√°cil de alternar vers√µes, configura√ß√£o autom√°tica de hosts | Requer rein√≠cio manual do servidor web ao adicionar um novo projeto     |

> **Exemplo com Docker (Laravel Sail):**
> ```dockerfile
> # Ap√≥s a instala√ß√£o do Docker
> ./vendor/bin/sail up
> ```

---

#### **4. Instala√ß√£o do PHP e Composer**
**Se n√£o estiver usando o Herd:**

1. PHP:
   	- Baixe o [PHP 8.3 para Windows](https://windows.php.net/download/)
   	- Descompacte em `C:\PHP`
   	- Adicione ao PATH:
     ```powershell
	 # Recomenda-se executar no PowerShell como administrador
     [Environment]::SetEnvironmentVariable("Path", "$env:Path;C:\PHP", "User")
     ```
2. Composer:
   	- Execute [Composer-Setup.exe](https://getcomposer.org/download/)
   	- Verifica√ß√£o:
     ```cmd
     php -v
     composer --version
     ```

---

#### **5. Instala√ß√£o do PostgreSQL**
**Para trabalhar com bancos de dados:**

1. Baixe o [PostgreSQL 15](https://www.postgresql.org/download/windows/)
2. Execute o instalador:
   - Senha para o superusu√°rio: `admin` (ou sua pr√≥pria)
   - Porta: `5432` (padr√£o)
3. Ap√≥s a instala√ß√£o:
   - Abra o **pgAdmin 4** (cliente gr√°fico)
   > Voc√™ pode usar qualquer outro cliente para trabalhar com o banco de dados, por exemplo, DBeaver, DataGrip ou at√© mesmo a linha de comando.
   > Eu prefiro DBeaver - mas √© uma quest√£o de gosto
   - Crie um banco de dados para o projeto: `space_api`

---

#### **6. Instala√ß√£o do Laravel**
1. Via Composer:
```bash
composer create-project laravel/laravel space-api
cd space-api
```

2. Inicializa√ß√£o do Git (opcional):
```bash
git init
git add .
git commit -m "In√≠cio do projeto espacial"
```

3. Iniciando e Verificando o Servidor:
>Se voc√™ estiver usando Herd:
Certifique-se de que seu projeto space-api esteja na pasta que voc√™ adicionou ao Herd.
Abra no navegador o endere√ßo: http://space-api.test
Voc√™ dever√° ver a p√°gina inicial do Laravel. O servidor j√° est√° funcionando gra√ßas ao Herd!

Se voc√™ N√ÉO estiver usando Herd (instala√ß√£o manual):
```bash
php artisan serve
```
Abra no navegador: [http://localhost:8000](http://localhost:8000) ‚Üí A p√°gina inicial do Laravel dever√° aparecer!

### Ao criar um projeto no Herd:

Basta seguir as instru√ß√µes na tela. Para facilitar, o nome do projeto ser√° `space-api`. Starter kit - qualquer um, mas eu prefiro React.

##### Certifique-se de incluir o phpunit - ele nos ser√° √∫til mais adiante

---

#### **7. Configura√ß√£o do Projeto**
**Arquivos Importantes:**

- `.env` ‚Äî configura√ß√µes de ambiente (chaves, bancos de dados)
- `config/database.php` ‚Äî configura√ß√£o do SGBD
- `composer.json` ‚Äî depend√™ncias PHP

**Conex√£o do BD ao Projeto:**

Adicione em `.env`:

```env
DB_CONNECTION=pgsql
DB_HOST=127.0.0.1
DB_PORT=5432
DB_DATABASE=space_api
DB_USERNAME=postgres # Login para postgres
DB_PASSWORD=admin # Senha para postgres
```

**Primeiros comandos Artisan:**
```bash
php artisan key:generate  # Gera√ß√£o da chave da aplica√ß√£o
php artisan migrate:fresh # Migra√ß√£o do banco de dados (Ao mudar para postgres)
```

---

#### **Quiz para Fixa√ß√£o**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. Herd √©...</p>
      <label><input type="radio" name="q1" value="a"> a) Uma ferramenta para gerenciar o ambiente PHP</label>
      <label><input type="radio" name="q1" value="b"> b) Um editor de c√≥digo</label>
      <label><input type="radio" name="q1" value="c"> c) Um sistema operacional</label>
    </div>
    <div class="question">
      <p>2. Qual ferramenta o Laravel usa para gerenciar as depend√™ncias do PHP?</p>
      <label><input type="radio" name="q2" value="a"> a) npm</label>
      <label><input type="radio" name="q2" value="b"> b) Composer</label>
      <label><input type="radio" name="q2" value="c"> c) Artisan</label>
    </div>
    <div class="question">
      <p>3. Porta padr√£o para PostgreSQL:</p>
      <label><input type="radio" name="q3" value="a"> a) 3306</label>
      <label><input type="radio" name="q3" value="b"> b) 5432</label>
      <label><input type="radio" name="q3" value="c"> c) 8000</label>
    </div>
    <div class="question">
      <p>4. Comando para criar um projeto Laravel via Composer:</p>
      <label><input type="radio" name="q4" value="a"> a) composer create-laravel</label>
      <label><input type="radio" name="q4" value="b"> b) laravel new</label>
      <label><input type="radio" name="q4" value="c"> c) composer create-project laravel/laravel</label>
    </div>
    <div class="question">
      <p>5. Arquivo com as configura√ß√µes de ambiente?</p>
      <label><input type="radio" name="q5" value="a"> a) .env</label>
      <label><input type="radio" name="q5" value="b"> b) config.php</label>
      <label><input type="radio" name="q5" value="c"> c) settings.ini</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Verificar</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'a', q2: 'b', q3: 'b', q4: 'c', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Resultados:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:green;">Correto!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:red;">Incorreto.</span> Resposta correta: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:orange;">Sem resposta.</span></li>`;
      }
    }
</script>
resultsHTML += `</ul><p><b>Seu resultado: ${score} de ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

### **üöÄ Resumo do Cap√≠tulo**
> Voc√™ implantou o "ponto de partida" para a API espacial! Agora voc√™ tem:

> - üõ†Ô∏è Ambiente local (Herd ou instala√ß√£o manual) com PHP e Nginx
> - üêò Servidor de banco de dados PostgreSQL instalado
> - üöÄ Projeto Laravel `space-api`
> - üîå Conex√£o configurada ao banco de dados
>
> **üìå Verifica√ß√£o:**

> - **Se voc√™ est√° com Herd:** Certifique-se de que o site abre no endere√ßo `http://space-api.test`.
> - **Se sem Herd:** Certifique-se de que o comando `php artisan serve` funciona e o site abre no endere√ßo `http://localhost:8000`.
> - De qualquer forma, verifique se o banco de dados `space_api` criado est√° vis√≠vel no `pgAdmin 4`.