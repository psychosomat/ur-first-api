# **ç¬¬6.1ç« ï¼šå°†FastAPIä¸å‰ç«¯è¿æ¥**
**å­¦ä¹ æ—¶é—´ï¼š** 30åˆ†é’Ÿ

---

#### **1. å›å½’â€œè¶…å…‰é€Ÿå¼•æ“â€ï¼šåè®®æ¯”è¾ƒ**
åœ¨ä¸Šä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†ä»»åŠ¡æ§åˆ¶ä¸­å¿ƒï¼ˆå‰ç«¯ï¼‰ä¸â€œå›½é™…ç©ºé—´ç«™â€ï¼ˆLaravel APIï¼‰æˆåŠŸå¯¹æ¥ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å›åˆ°æˆ‘ä»¬çš„**è¶…å…‰é€Ÿæˆ˜æ–—æœº**ï¼ˆFastAPIï¼‰ï¼Œå¹¶æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚

æœ¬ç« çš„ç›®æ ‡ä¸ä»…ä»…æ˜¯é‡å¤æ“ä½œï¼Œè€Œæ˜¯**æ¯”è¾ƒä¸¤ç§æ–¹æ³•**ã€‚è¿™å°±åƒåŒä¸€è‰˜é¾™é£èˆ¹ï¼Œå…ˆä¸å›½é™…ç©ºé—´ç«™å¯¹æ¥ï¼Œç„¶åä¸ä¸­å›½ç©ºé—´ç«™â€œå¤©å®«â€å¯¹æ¥ã€‚å¯¹æ¥æ¥å£ç›¸åŒï¼ˆRESTï¼‰ï¼Œä½†åœ¨ç¨‹åºå’Œç«¯å£ä½ç½®ä¸Šå¯èƒ½ä¼šæœ‰ç»†å¾®å·®åˆ«ã€‚

> ğŸ’¡ **å®‡å®™ç±»æ¯”ï¼š**

> è¿‡ç¨‹ç›¸åŒï¼šé è¿‘ã€å¯¹é½ã€å¯¹æ¥ã€‚ä½†å¯¹äºâ€œå›½é™…ç©ºé—´ç«™â€ï¼Œéœ€è¦ä½¿ç”¨ `/api/planets` ç«¯å£ï¼Œè€Œå¯¹äºâ€œå¤©å®«â€ï¼Œåˆ™éœ€è¦ä½¿ç”¨ `/spaceships` ç«¯å£ã€‚æˆ‘ä»¬ä»»åŠ¡æ§åˆ¶ä¸­å¿ƒçš„æ“ä½œå‘˜å¿…é¡»äº†è§£è¿™äº›ç»†èŠ‚ï¼Œæ‰èƒ½ç¡®ä¿ä»»åŠ¡æˆåŠŸã€‚

---

#### **2. å‡†å¤‡â€œæˆ˜æ–—æœºâ€ï¼ˆFastAPIï¼‰è¿›è¡Œå¯¹æ¥**

æˆ‘ä»¬å·²åœ¨ç¬¬4.2ç« ä¸­å®Œæˆæ­¤æ“ä½œï¼Œä½†è®©æˆ‘ä»¬ç¡®ä¿ä¸€åˆ‡å°±ç»ªã€‚

**æ­¥éª¤1ï¼šå¯åŠ¨FastAPIæœåŠ¡å™¨**

1.  å¦‚æœLaravelæœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œè¯·å°†å…¶åœæ­¢ï¼ˆä»¥é¿å…ç«¯å£å†²çªï¼‰ã€‚
2.  åœ¨ä½ çš„FastAPIé¡¹ç›®æ–‡ä»¶å¤¹ä¸­æ‰“å¼€ç»ˆç«¯ã€‚
3.  æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š

    - **Windowsï¼š** `.\venv\Scripts\Activate.ps1`
    - **macOS / Linuxï¼š** `source venv/bin/activate`

4.  å¯åŠ¨æœåŠ¡å™¨ï¼š
    ```bash
    uvicorn main:app --reload
    ```
    æœåŠ¡å™¨å°†é€šè¿‡ `http://127.0.0.1:8000` åœ°å€è®¿é—®ã€‚

**æ­¥éª¤2ï¼šæ£€æŸ¥ `main.py` ä¸­çš„CORSè®¾ç½®**

ç¡®ä¿ä½ çš„FastAPIé¡¹ç›®ä¸­é…ç½®äº†æˆ‘ä»¬ä¹‹å‰æ·»åŠ çš„ `CORSMiddleware`ã€‚å®ƒåº”è¯¥å…è®¸æ¥è‡ªå‰ç«¯åœ°å€çš„è¯·æ±‚ã€‚
```python
# main.py
from fastapi.middleware.cors import CORSMiddleware

# ...

origins = [
    "http://127.0.0.1:5500", # Live Serveråœ°å€
    "null", # ç”¨äº file:///
]

app.add_middleware(
    CORSMiddleware,
    allow_origins=origins,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# ...
```
å¦‚æœä¸€åˆ‡å°±ç»ªï¼Œä½ çš„FastAPIæœåŠ¡å™¨å·²å®Œå…¨å‡†å¤‡å¥½ã€‚

---

#### **3. å°†ä»»åŠ¡æ§åˆ¶ä¸­å¿ƒçš„â€œå¤©çº¿â€é‡æ–°æŒ‡å‘FastAPI**

ç°åœ¨æœ€æœ‰è¶£çš„éƒ¨åˆ†æ¥äº†â€”â€”æˆ‘ä»¬éœ€è¦å¯¹JavaScriptè¿›è¡Œæœ€å°çš„æ›´æ”¹ï¼Œä½¿å…¶å†æ¬¡ä¸FastAPIååŒå·¥ä½œã€‚

**æ­¥éª¤1ï¼šæ›´æ”¹åŸºç¡€URL**

æ‰“å¼€ `api.js` å¹¶å°† `API_BASE_URL` æ¢å¤ä¸ºå…¶åˆå§‹å€¼ã€‚
```javascript
// api.js

// æŒ‡å®šæˆ‘ä»¬çš„FastAPI APIçš„URL
const API_BASE_URL = 'http://127.0.0.1:8000'; // <-- ä¸å¸¦ /apiï¼

// ... apiRequest çš„å…¶ä½™ä»£ç  ...
```

**æ­¥éª¤2ï¼šé€‚åº”FastAPIçš„å“åº”ç»“æ„**

å›æƒ³ä¸€ä¸‹ï¼Œæˆ‘ä»¬çš„FastAPIä¸­çš„ `GET /spaceships` è¿”å›çš„æ˜¯ä¸€ä¸ª**ç®€å•æ•°ç»„**ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¸¦åˆ†é¡µçš„å¯¹è±¡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦å°† `fetchAndDisplayFleet` ä»£ç æ¢å¤åˆ°å…¶åŸå§‹çŠ¶æ€ã€‚

**ä¿®æ”¹ `app.js` ä¸­çš„ `fetchAndDisplayFleet` å‡½æ•°ï¼š**
```javascript
// app.js

async function fetchAndDisplayFleet() {
    try {
        fleetListContainer.innerHTML = '<p>æ­£åœ¨ä»FastAPIåŠ è½½é¥æµ‹æ•°æ®...</p>';
        const ships = await apiRequest('/spaceships'); // <-- è¯·æ±‚ /spaceships

        // åœ¨FastAPIä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•æ•°ç»„ï¼Œå› æ­¤ä¸éœ€è¦ .data é”®ï¼

        fleetListContainer.innerHTML = '';
        if (ships.length === 0) {
            fleetListContainer.innerHTML = '<p>æ³¨å†Œè¡¨ä¸­æ²¡æœ‰è®¾å¤‡ã€‚</p>';
            return;
        }

        ships.forEach(ship => {
            // æ¢å¤æˆ‘ä»¬åŸå§‹çš„åˆ›å»ºå¡ç‰‡å‡½æ•°
            const card = createShipCard(ship);
            fleetListContainer.appendChild(card);
        });
    } catch (error) {
        fleetListContainer.innerHTML = `<p style="color: #ff6b6b;">èˆ°é˜ŸåŠ è½½é”™è¯¯ï¼š${error.message}</p>`;
    }
}

// åˆ›å»ºé£èˆ¹å¡ç‰‡çš„åŸå§‹å‡½æ•°
function createShipCard(ship) {
    const card = document.createElement('div');
    card.className = 'card';
    card.innerHTML = `
        <h3>${ship.name} (ID: ${ship.id})</h3>
        <p>ç±»å‹: ${ship.type}</p>
        <p>å‘å°„å¹´ä»½: ${ship.launch_year}</p>
        <p>çŠ¶æ€: ${ship.status}</p>
        <div class="card-actions">
            <button class="edit-btn" data-ship-id="${ship.id}">ä¿®æ”¹</button>
            <button class="delete-btn" data-ship-id="${ship.id}">æŠ¥åºŸ</button>
        </div>
    `;
    return card;
}
```

**æ­¥éª¤3ï¼šCRUDæ“ä½œæ£€æŸ¥**

ç”±äºFastAPIä¸­çš„Pydanticæ¨¡å‹å’ŒHTMLè¡¨å•ä¸­çš„å­—æ®µï¼ˆ`name`ã€`type`ã€`launch_year`ã€`status`ï¼‰æ˜¯åŒ¹é…çš„ï¼Œ`handleSaveShip` å’Œ `handleDeleteShip` å‡½æ•°åº”è¯¥**æ— éœ€æ›´æ”¹**å³å¯å·¥ä½œï¼Œå› ä¸ºå®ƒä»¬å·²ç»æŒ‡å‘ `/spaceships` ç«¯ç‚¹ã€‚

---

#### **4. æ¯”è¾ƒæ€»ç»“ï¼šè¿™å¯¹å‰ç«¯å¼€å‘è€…æ„å‘³ç€ä»€ä¹ˆï¼Ÿ**

- **RESTçš„é€šç”¨æ€§ï¼š** ä½ äº²èº«éªŒè¯äº†ï¼Œå¦‚æœéµå¾ªRESTåŸåˆ™ï¼Œå‰ç«¯å¯¹äºåç«¯æ˜¯ç”¨ä»€ä¹ˆè¯­è¨€ç¼–å†™ï¼ˆPHP/Laravelè¿˜æ˜¯Python/FastAPIï¼‰å¹¶ä¸é‡è¦ã€‚
- **æ–‡æ¡£çš„é‡è¦æ€§ï¼š** ä¸»è¦åŒºåˆ«åœ¨äº**ç«¯ç‚¹URL**å’Œ**JSONå“åº”ç»“æ„**ã€‚è¿™æ­£æ˜¯APIæ–‡æ¡£ä¸­åº”è¯¥æè¿°çš„å†…å®¹ã€‚æ²¡æœ‰æ–‡æ¡£ï¼Œå‰ç«¯å¼€å‘è€…å°†â€œç›²ç›®â€å·¥ä½œã€‚
- **å‰ç«¯çš„çµæ´»æ€§ï¼š** ä½ çš„JavaScriptä»£ç åº”è¯¥è¶³å¤Ÿçµæ´»ï¼Œä»¥ä¾¿è½»æ¾é€‚åº”ä¸åŒçš„æ•°æ®æ ¼å¼ï¼ˆä¾‹å¦‚ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨ `data` é”®ï¼Œæˆ–è€…å®ƒåªæ˜¯ä¸€ä¸ªç®€å•æ•°ç»„ï¼‰ã€‚

**ç»“è®ºï¼š** ä½¿ç”¨REST APIçš„æŠ€èƒ½æ˜¯ä¸€æŠŠ**é€šç”¨é’¥åŒ™**ï¼Œå®ƒèƒ½æ‰“å¼€ä¸ä»»ä½•ç°ä»£åç«¯äº¤äº’çš„å¤§é—¨ã€‚

---

#### **å·©å›ºçŸ¥è¯†å°æµ‹éªŒ**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. æˆ‘ä»¬çš„Laravel APIå’ŒFastAPI APIä¹‹é—´URLçš„ä¸»è¦åŒºåˆ«åœ¨äº...</p>
      <label><input type="radio" name="q1" value="a"> a) ä½¿ç”¨ä¸åŒçš„ç«¯å£</label>
      <label><input type="radio" name="q1" value="b"> b) Laravelå¸¦æœ‰ `/api` å‰ç¼€</label>
      <label><input type="radio" name="q1" value="c"> c) FastAPIä½¿ç”¨HTTPS</label>
    </div>
    <div class="question">
      <p>2. ä»Laravelçš„åˆ†é¡µå“åº”åˆ‡æ¢åˆ°FastAPIçš„ç®€å•æ•°ç»„æ—¶ï¼ŒJSä»£ç éœ€è¦è¿›è¡Œå“ªäº›ä¸»è¦æ›´æ”¹ï¼Ÿ</p>
      <label><input type="radio" name="q2" value="a"> a) åœæ­¢è®¿é—® `responseData.data`ï¼Œç›´æ¥ä½¿ç”¨ `responseData`</label>
      <label><input type="radio" name="q2" value="b"> b) ä½¿ç”¨ä¸åŒçš„ `fetch` æ–¹æ³•</label>
      <label><input type="radio" name="q2" value="c"> c) æ›´æ”¹HTTPå¤´ä¸­çš„ `Content-Type`</label>
    </div>
    <div class="question">
      <p>3. è¿™é¡¹å®éªŒè¯æ˜ï¼Œå¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´...</p>
      <label><input type="radio" name="q3" value="a"> a) äº†è§£PHPå’ŒPythonéƒ½å¾ˆé‡è¦</label>
      <label><input type="radio" name="q3" value="b"> b) é‡è¦çš„æ˜¯ç†è§£RESTåŸåˆ™å¹¶èƒ½å¤Ÿé˜…è¯»APIæ–‡æ¡£</label>
      <label><input type="radio" name="q3" value="c"> c) Laravelå’ŒFastAPIæ˜¯å®Œå…¨ç›¸åŒçš„</label>
    </div>
    <div class="question">
      <p>4. CORSçš„é…ç½®æ˜¯...</p>
      <label><input type="radio" name="q4" value="a"> a) å‰ç«¯å¼€å‘è€…çš„ä»»åŠ¡</label>
      <label><input type="radio" name="q4" value="b"> b) ç³»ç»Ÿç®¡ç†å‘˜çš„ä»»åŠ¡</label>
      <label><input type="radio" name="q4" value="c"> c) åç«¯å¼€å‘è€…çš„ä»»åŠ¡</label>
    </div>
    <div class="question">
      <p>5. å¦‚æœFastAPIä¹ŸåƒLaravelä¸€æ ·ä½¿ç”¨åˆ†é¡µï¼Œå‰ç«¯éœ€è¦åšä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q5" value="a"> a) ä»€ä¹ˆéƒ½ä¸ç”¨åšï¼Œä»£ç ä¼šè‡ªåŠ¨è¿è¡Œ</label>
      <label><input type="radio" name="q5" value="b"> b) å†æ¬¡ä¿®æ”¹é€»è¾‘ï¼Œä» `data` é”®ï¼ˆæˆ–ç±»ä¼¼é”®ï¼‰ä¸­æå–æ•°ç»„</label>
      <label><input type="radio" name="q5" value="c"> c) ä» `fetch` åˆ‡æ¢åˆ° Axios åº“</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">æ£€æŸ¥</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'a', q3: 'b', q4: 'c', q5: 'b' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>ç»“æœï¼š</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:green;">æ­£ç¡®ï¼</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:red;">é”™è¯¯ã€‚</span> æ­£ç¡®ç­”æ¡ˆ: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:orange;">æ²¡æœ‰ç­”æ¡ˆã€‚</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>ä½ çš„å¾—åˆ†: ${score} / ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**ğŸš€ æœ¬ç« æ€»ç»“ï¼š**

ä½ æˆåŠŸåˆ‡æ¢äº†ä»»åŠ¡æ§åˆ¶ä¸­å¿ƒçš„â€œé€šä¿¡åè®®â€ï¼Œå¹¶å®è·µæ¯”è¾ƒäº†ä¸ä¸¤ç§ä¸åŒåç«¯ç³»ç»Ÿçš„å·¥ä½œã€‚

- âœ… ä½ å·©å›ºäº†è°ƒæ•´ `API_BASE_URL` ä»¥åœ¨æœåŠ¡å™¨ä¹‹é—´åˆ‡æ¢çš„æŠ€èƒ½ã€‚
- âœ… ä½ ç†è§£äº†å“åº”ç»“æ„ï¼ˆ`data` ä¸ç®€å•æ•°ç»„ï¼‰çš„é‡è¦æ€§ä»¥åŠå¦‚ä½•ä½¿å‰ç«¯é€‚åº”å®ƒã€‚
- âœ… ä½ æ„è¯†åˆ°ä¸€åä¼˜ç§€çš„å‰ç«¯å¼€å‘è€…åº”è¯¥å‡†å¤‡å¥½å¤„ç†ä»»ä½•RESTful APIï¼Œå¹¶ä»”ç»†ç ”ç©¶å…¶æ–‡æ¡£ã€‚

**é€šç”¨å¯¹æ¥æŠ€èƒ½å·²è·å¾—ï¼** ç°åœ¨æˆ‘ä»¬å·²ç»æŒæ¡äº†åŸºæœ¬è¿æ¥çš„è®¾ç½®ï¼Œæ˜¯æ—¶å€™è®¨è®ºæ›´å¤æ‚çš„åè®®äº†â€”â€”CORSã€èº«ä»½éªŒè¯å’Œå®‰å…¨æ€§ã€‚

> **ğŸ“Œ æ£€æŸ¥ç‚¹ï¼š**

> - ç¡®ä¿ä½ çš„FastAPIæœåŠ¡å™¨æ­£åœ¨è¿è¡Œã€‚
> - ç¡®ä¿ä½ å·²å°† `API_BASE_URL` å’Œ `app.js` ä¸­çš„å“åº”å¤„ç†é€»è¾‘æ¢å¤åˆ°FastAPIç‰ˆæœ¬ã€‚
> - æ£€æŸ¥ä½ çš„å‰ç«¯æ˜¯å¦å†æ¬¡æ­£ç¡®æ‰§è¡Œä¸FastAPIåç«¯çš„æ‰€æœ‰CRUDæ“ä½œã€‚

> **âš ï¸ å¦‚æœå‡ºç°é”™è¯¯ï¼š**

> - **CORS errorï¼š** ç¡®ä¿FastAPIæœåŠ¡å™¨ä»¥æ­£ç¡®çš„CORSè®¾ç½®è¿è¡Œã€‚
> - **é”™è¯¯ `Cannot read properties of undefined (reading 'length')`ï¼š** ä½ å¯èƒ½å¿˜è®°ä» `responseData` ä¸­ç§»é™¤ `.data` çš„è®¿é—®ã€‚
> - **404 Not Foundï¼š** æ£€æŸ¥ `API_BASE_URL` â€”â€” FastAPIæ²¡æœ‰ `/api` å‰ç¼€ã€‚