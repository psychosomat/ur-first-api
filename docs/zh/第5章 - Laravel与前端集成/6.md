# **ç¬¬5.6ç« ï¼šé€šè¿‡ Blade + Fetch æ˜¾ç¤ºæ•°æ®**
**å­¦ä¹ æ—¶é—´ï¼š** 50åˆ†é’Ÿ

---

### **1. æ··åˆæ–¹æ³•ï¼šä¸¤å…¨å…¶ç¾**

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼æ„å»ºé¡µé¢ï¼š

1.  **å®Œæ•´æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR)ï¼š** Laravel ç”Ÿæˆæ‰€æœ‰ HTMLï¼ŒåŒ…æ‹¬è¡Œæ˜Ÿåˆ—è¡¨ã€‚å¯¹äºä»»ä½•æ›´æ–°ï¼ˆåˆ é™¤ã€æ·»åŠ ï¼‰ï¼Œé¡µé¢éƒ½ä¼šå®Œå…¨é‡æ–°åŠ è½½ã€‚
2.  **å®Œæ•´å®¢æˆ·ç«¯æ¸²æŸ“ (CSR)ï¼š** Laravel è¿”å›ä¸€ä¸ªç©ºçš„ HTMLâ€œå¤–å£³â€ï¼Œç„¶å JavaScript ä» API è¯·æ±‚æ‰€æœ‰æ•°æ®å¹¶åœ¨å®¢æˆ·ç«¯æ¸²æŸ“å®ƒä»¬ã€‚ï¼ˆè¿™æ˜¯å•é¡µåº”ç”¨ç¨‹åº - SPA çš„æ–¹æ³•ï¼‰ã€‚

**æˆ‘ä»¬çš„é€‰æ‹©æ˜¯æ··åˆæ–¹æ³•ï¼š**

-   **é¦–æ¬¡åŠ è½½ (SSR)ï¼š** Laravel ç«‹å³è¿”å›å¸¦æœ‰é¢„å…ˆå‡†å¤‡å¥½çš„è¡Œæ˜Ÿåˆ—è¡¨çš„é¡µé¢ã€‚è¿™é€Ÿåº¦å¿«ï¼Œå¯¹ SEO å‹å¥½ã€‚ç”¨æˆ·ç«‹å³çœ‹åˆ°å†…å®¹ã€‚
-   **åç»­æ“ä½œ (CSR)ï¼š** JavaScript æ•è·ç”¨æˆ·æ“ä½œï¼ˆæŒ‰é’®ç‚¹å‡»ï¼‰å¹¶ä¸ API äº¤äº’ï¼Œä»…æ›´æ–°é¡µé¢æ‰€éœ€éƒ¨åˆ†ï¼Œè€Œæ— éœ€å®Œå…¨é‡æ–°åŠ è½½ã€‚

> ğŸ’¡ **å®‡å®™ç±»æ¯”ï¼š**

> å½“ä½ è¿›å…¥èˆ°æ¡¥æ—¶ï¼ŒæŒ‡æŒ¥ä¸­å¿ƒï¼ˆSSRï¼‰ç«‹å³ç»™ä½ ä¸€å¼ ä¸»å¯¼èˆªå›¾ã€‚å®ƒå·²ç»åœ¨ä½ æ‰‹ä¸­ï¼Œæ— éœ€ç­‰å¾…ã€‚ä½†éšåä½ ä¼šåœ¨ä½ çš„å¹³æ¿ç”µè„‘ä¸Šæ¿€æ´»â€œå®æ—¶æ¨¡å¼â€ï¼ˆCSRï¼‰ï¼Œå®ƒå°†å¼€å§‹ä»å«æ˜Ÿæ¥æ”¶å®æ—¶æ›´æ–°ï¼Œé‡æ–°ç»˜åˆ¶ä½ åœ°å›¾ä¸Šçš„ç‰©ä½“ã€‚

---

### **2. æ­¥éª¤ 1ï¼šå‡†å¤‡é¡µé¢**

æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„è¡Œæ˜Ÿåˆ—è¡¨é¡µé¢ `resources/views/planets/index.blade.php`ã€‚å®ƒå·²ç»èƒ½å¤Ÿæ˜¾ç¤ºä»æ§åˆ¶å™¨ä¼ é€’çš„æ•°æ®ã€‚ç°åœ¨æˆ‘ä»¬å°†åœ¨å…¶ä¸Šæ·»åŠ é€šè¿‡ JS å·¥ä½œæ§ä»¶ã€‚

**æ·»åŠ â€œåˆ·æ–°åˆ—è¡¨â€æŒ‰é’®å’Œé€šçŸ¥å®¹å™¨ï¼š**
```html
    <div class="controls">
        <h2>æ‰€æœ‰å·²çŸ¥è¡Œæ˜Ÿåˆ—è¡¨</h2>
        <button id="refresh-btn">é€šè¿‡ API åˆ·æ–°</button>
    </div>
    <div id="notification-area" class="notification"></div>
    <hr>
    {{-- è¿™ä¸ª div å°†ä½œä¸ºæˆ‘ä»¬åŠ¨æ€æ›´æ–°çš„å®¹å™¨ --}}
    <div id="planet-list-container" class="planet-list">
        {{-- åŒ…å«â€œå­â€è§†å›¾ï¼Œå®ƒæ¸²æŸ“åˆå§‹åˆ—è¡¨ --}}
        @include('planets.partials.list', ['planets' => $planets])
    </div>
```

è¯·æ³¨æ„ `@include('planets.partials.list', ...)`ã€‚æˆ‘ä»¬å°†åˆ—è¡¨æ˜¾ç¤ºé€»è¾‘æå–åˆ°ä¸€ä¸ªå•ç‹¬çš„å¯é‡ç”¨æ–‡ä»¶ä¸­ã€‚

---

### **æ­¥éª¤ 2ï¼šåˆ›å»ºå¯é‡ç”¨â€œå±€éƒ¨â€è§†å›¾ (Partial)**

å°†é‡å¤çš„éƒ¨åˆ†æå–åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚

åˆ›å»ºæ–‡ä»¶ `resources/views/planets/partials/list.blade.php`ï¼š

```blade
@forelse($planets as $planet)
    <div class="planet-card" id="planet-card-{{ $planet->id }}">
        <h3>{{ $planet->name }}</h3>
        <p>å¤ªé˜³ç³»ï¼š{{ $planet->solar_system }}</p>
        <p>ç›´å¾„ï¼š{{ number_format($planet->size_km, 0, '.', ' ') }} å…¬é‡Œ</p>
        <a href="{{ route('planets.show', $planet) }}">äº†è§£æ›´å¤š &rarr;</a>
        <button class="delete-btn" data-id="{{ $planet->id }}" data-url="{{ route('api.planets.destroy', $planet) }}">
            é€€å½¹
        </button>
    </div>
@empty
    <p>æ•°æ®åº“ä¸­æ²¡æœ‰è¡Œæ˜Ÿã€‚</p>
@endforelse
```

-   **é‡è¦ï¼š** è¯·æ³¨æ„ï¼Œåˆ é™¤æŒ‰é’®çš„ URL ç°åœ¨æ˜¯ä¸º API è·¯ç”±ç”Ÿæˆçš„ï¼š`route('api.planets.destroy', $planet)`ã€‚ä¸ºæ­¤ï¼Œè¯·ç¡®ä¿åœ¨ `routes/api.php` ä¸­æ‚¨æœ‰ä¸€ä¸ªå‘½åèµ„æºï¼š`Route::apiResource('planets', ...)->name('api.planets');`

---

### **æ­¥éª¤ 3ï¼šç¼–å†™ç”¨äºåŠ¨æ€æ›´æ–°çš„ JavaScript**

ç°åœ¨æ˜¯æœ€æœ‰è¶£çš„éƒ¨åˆ†ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª JavaScriptï¼Œå®ƒå°†é€šè¿‡æŒ‰é’®å‘ API è¯·æ±‚æœ€æ–°çš„è¡Œæ˜Ÿåˆ—è¡¨å¹¶é‡æ–°æ¸²æŸ“å®ƒã€‚

åˆ›å»ºæ–‡ä»¶ `public/js/planet-manager.js` å¹¶å°†å…¶å¼•å…¥åˆ° `layouts/app.blade.php` ä¸­ã€‚

```javascript
document.addEventListener('DOMContentLoaded', () => {
    const refreshBtn = document.getElementById('refresh-btn');
    const planetListContainer = document.getElementById('planet-list-container');
    const notificationArea = document.getElementById('notification-area');

    // ç”¨äºæ˜¾ç¤ºé€šçŸ¥çš„å‡½æ•°
    function showNotification(message, isError = false) {
        notificationArea.textContent = message;
        notificationArea.className = isError ? 'notification error' : 'notification success';
        setTimeout(() => {
            notificationArea.textContent = '';
            notificationArea.className = 'notification';
        }, 3000);
    }

    // ç”¨äºæ¸²æŸ“å•ä¸ªè¡Œæ˜Ÿå¡çš„å‡½æ•°
    function createPlanetCardHtml(planet) {
        // é‡è¦ï¼šæˆ‘ä»¬ç”Ÿæˆä¸æˆ‘ä»¬çš„ partial è§†å›¾ç›¸åŒçš„ HTML
        return `
            <div class="planet-card" id="planet-card-${planet.id}">
                <h3>${planet.name}</h3>
                <p>å¤ªé˜³ç³»ï¼š${planet.solar_system}</p>
                <p>ç›´å¾„ï¼š${new Intl.NumberFormat().format(planet.size_km)} å…¬é‡Œ</p>
                <a href="/planets/${planet.id}">äº†è§£æ›´å¤š &rarr;</a>
                <button class="delete-btn" data-id="${planet.id}" data-url="/api/planets/${planet.id}">
                    é€€å½¹ (JS)
                </button>
            </div>
        `;
    }

    // ç”¨äºè¯·æ±‚å’Œé‡æ–°æ¸²æŸ“è¡Œæ˜Ÿåˆ—è¡¨çš„å‡½æ•°
    async function fetchAndRenderPlanets() {
        showNotification('æ­£åœ¨ä»è½¨é“å«æ˜Ÿè¯·æ±‚æœ€æ–°æ•°æ®...');
        try {
            const response = await fetch('/api/planets', {
                headers: { 'Accept': 'application/json' }
            });

            if (!response.ok) {
                throw new Error('è·å–æ•°æ®æ—¶å‘ç”Ÿç½‘ç»œé”™è¯¯ã€‚');
            }

            const planets = await response.json(); // Laravel é»˜è®¤ä¼šä¸ºåˆ†é¡µèµ„æºè¿”å› { data: [...] }

            planetListContainer.innerHTML = ''; // æ¸…é™¤æ—§åˆ—è¡¨

            if (planets.data.length === 0) {
                planetListContainer.innerHTML = '<p>æ•°æ®åº“ä¸­æ²¡æœ‰è¡Œæ˜Ÿã€‚</p>';
            } else {
                planets.data.forEach(planet => {
                    const cardHtml = createPlanetCardHtml(planet);
                    planetListContainer.innerHTML += cardHtml;
                });
            }
            showNotification('æ•°æ®å·²æˆåŠŸæ›´æ–°ï¼', false);
        } catch (error) {
            console.error('æ›´æ–°è¡Œæ˜Ÿåˆ—è¡¨æ—¶å‡ºé”™ï¼š', error);
            showNotification(error.message, true);
        }
    }

    // ä¸ºæŒ‰é’®æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
    if (refreshBtn) {
        refreshBtn.addEventListener('click', fetchAndRenderPlanets);
    }

    // å¯ä»¥å°†ä¸Šä¸€ç« çš„åˆ é™¤é€»è¾‘ç§»åˆ°è¿™é‡Œï¼Œ
    // ä»¥ä¾¿æ‰€æœ‰ JS éƒ½é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚
});
```

---

### **3. æœ€ç»ˆæ£€æŸ¥**

1.  **å¯åŠ¨æœåŠ¡å™¨**ï¼ˆ`php artisan serve` æˆ–ç¡®ä¿ Herd æ­£åœ¨è¿è¡Œï¼‰ã€‚
2.  **å¦‚æœéœ€è¦ï¼Œé‡æ–°åˆ›å»ºæ•°æ®åº“**ï¼š`php artisan migrate:fresh --seed`ã€‚
3.  åœ¨æµè§ˆå™¨ä¸­**æ‰“å¼€ `/planets` é¡µé¢**ã€‚
    -   æ‚¨åº”è¯¥ç«‹å³çœ‹åˆ°æœåŠ¡å™¨ç”Ÿæˆçš„è¡Œæ˜Ÿåˆ—è¡¨ã€‚
4.  **ç‚¹å‡»â€œé€šè¿‡ API åˆ·æ–°â€æŒ‰é’®**ã€‚
    -   æ‚¨å°†çœ‹åˆ°åŠ è½½é€šçŸ¥ã€‚
    -   åˆ—è¡¨åº”è¯¥ä¼šçŸ­æš‚æ¶ˆå¤±å¹¶é‡æ–°å‡ºç°ï¼Œä½†è¿™æ¬¡å®ƒå°†æ˜¯åŸºäºä» API è·å–çš„æ•°æ®ç”± JavaScript ç”Ÿæˆçš„ã€‚

æ‚¨å·²æˆåŠŸå®ç°æ··åˆæ¨¡å‹ï¼

---

### **å·©å›ºçŸ¥è¯†å°æµ‹éªŒ**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. ä»€ä¹ˆæ˜¯æ··åˆæ¸²æŸ“æ–¹æ³•ï¼ˆSSR + CSRï¼‰ï¼Ÿ</p>
      <label><input type="radio" name="q1" value="a"> a) é¦–å…ˆæ¸²æŸ“ä¸€ä¸ªç©ºé¡µé¢ï¼Œç„¶å JS åŠ è½½æ‰€æœ‰å†…å®¹</label>
      <label><input type="radio" name="q1" value="b"> b) æœåŠ¡å™¨è¿”å›ä¸€ä¸ªå®Œå…¨å‡†å¤‡å¥½çš„é¡µé¢ï¼Œå¹¶ä¸”å®ƒåœ¨å®¢æˆ·ç«¯æ°¸ä¸æ”¹å˜</label>
      <label><input type="radio" name="q1" value="c"> c) æœåŠ¡å™¨è¿”å›ä¸€ä¸ªå‡†å¤‡å¥½çš„é¡µé¢ä»¥å®ç°å¿«é€Ÿé¦–æ¬¡åŠ è½½ï¼Œåç»­æ›´æ–°é€šè¿‡ JS åœ¨å®¢æˆ·ç«¯è¿›è¡Œ</label>
    </div>
    <div class="question">
      <p>2. åˆå§‹æœåŠ¡å™¨ç«¯æ¸²æŸ“ (SSR) çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q2" value="a"> a) å‡å°‘æœåŠ¡å™¨è´Ÿè½½</label>
      <label><input type="radio" name="q2" value="b"> b) ä¸ºç”¨æˆ·å¿«é€Ÿé¦–æ¬¡æ¸²æŸ“å†…å®¹ä»¥åŠè‰¯å¥½çš„ SEO ç´¢å¼•</label>
      <label><input type="radio" name="q2" value="c"> c) ç®€åŒ– JavaScript ä»£ç </label>
    </div>
    <div class="question">
      <p>3. ç¤ºä¾‹ä¸­ä¸ºä»€ä¹ˆä½¿ç”¨ `@include('planets.partials.list')`ï¼Ÿ</p>
      <label><input type="radio" name="q3" value="a"> a) è¿™æ˜¯ Blade å¾ªç¯çš„è¦æ±‚</label>
      <label><input type="radio" name="q3" value="b"> b) ä¸ºäº†ä»£ç é‡ç”¨å’Œåˆ†ç¦»åˆ—è¡¨æ˜¾ç¤ºé€»è¾‘</label>
      <label><input type="radio" name="q3" value="c"> c) ç”¨äºå¼‚æ­¥åŠ è½½é¡µé¢çš„ä¸€éƒ¨åˆ†</label>
    </div>
    <div class="question">
      <p>4. åœ¨ JavaScript ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¤åˆ¶äº†å¡ç‰‡çš„ HTML ç»“æ„ã€‚æœ‰ä»€ä¹ˆæ›´é«˜çº§çš„æ–¹æ³•å¯ä»¥é¿å…è¿™ç§æƒ…å†µï¼Ÿ</p>
      <label><input type="radio" name="q4" value="a"> a) ä¸å‘ API è¯·æ±‚ JSONï¼Œè€Œæ˜¯è¯·æ±‚å·²æ¸²æŸ“å¥½çš„å•ä¸ªå¡ç‰‡ HTML</label>
      <label><input type="radio" name="q4" value="b"> b) ä½¿ç”¨ JavaScript æ¨¡æ¿å¼•æ“ï¼ˆå¦‚ Mustache, Handlebarsï¼‰æˆ–æ¡†æ¶ï¼ˆVue, Reactï¼‰</label>
      <label><input type="radio" name="q4" value="c"> c) ä¸¤ä¸ªé€‰é¡¹éƒ½æ­£ç¡®</label>
    </div>
    <div class="question">
      <p>5. ä¸ºä»€ä¹ˆ API (`/api/planets`) å’Œ JavaScript ä»£ç  (`createPlanetCardHtml`) ç”Ÿæˆä¸€è‡´çš„æ•°æ®/HTML å¾ˆé‡è¦ï¼Ÿ</p>
      <label><input type="radio" name="q5" value="a"> a) å¦åˆ™ç”¨æˆ·åœ¨é€šè¿‡ API æ›´æ–°æ—¶ä¼šçœ‹åˆ°ç•Œé¢â€œè·³åŠ¨â€æˆ–æ”¹å˜</label>
      <label><input type="radio" name="q5" value="b"> b) è¿™æ˜¯ Fetch API è§„èŒƒçš„è¦æ±‚</label>
      <label><input type="radio" name="q5" value="c"> c) å¦åˆ™ Laravel å°†è¿”å› 500 é”™è¯¯</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">æ£€æŸ¥</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'c', q2: 'b', q3: 'b', q4: 'c', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>ç»“æœï¼š</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;
```
if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:green;">æ­£ç¡®ï¼</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:red;">é”™è¯¯ã€‚</span> æ­£ç¡®ç­”æ¡ˆ: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:orange;">æ— ç­”æ¡ˆã€‚</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>æ‚¨çš„ç»“æœ: ${score} / ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**ğŸš€ æ­å–œæ‚¨å®Œæˆç¬¬5ç« ï¼**

æ‚¨å·²ç»ä» Blade åŸºç¡€çŸ¥è¯†å­¦åˆ°äº†åˆ›å»ºäº¤äº’å¼æ··åˆé¡µé¢çš„å·¨å¤§è¿›æ­¥ã€‚æ‚¨å­¦ä¼šäº†ï¼š

-   åˆ›å»ºå’Œä½¿ç”¨ Blade æ¨¡æ¿å’Œå¸ƒå±€ã€‚
-   ç»„ç»‡ç”¨äº CRUD æ“ä½œçš„ Web è·¯ç”±å’Œæ§åˆ¶å™¨ã€‚
-   ä½¿ç”¨ CSRF ä»¤ç‰Œä¿æŠ¤ Web è¡¨å•å’Œ AJAX è¯·æ±‚ã€‚
-   é›†æˆ JavaScript ä»¥åœ¨ä¸é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µä¸‹ä¸ API è¿›è¡ŒåŠ¨æ€äº¤äº’ã€‚

**æ‚¨çš„é£è¡Œæ§åˆ¶ä¸­å¿ƒå·²å®Œå…¨åŠŸèƒ½åŒ–ã€å®‰å…¨ä¸”äº¤äº’æ€§å¼ºã€‚** æ‚¨å·²å‡†å¤‡å¥½è¿›å…¥ä¸‹ä¸€ä¸ªé‡è¦é˜¶æ®µ â€” å°†æ­¤æ–¹æ³•ä¸å…¶ä»–æ¡†æ¶è¿›è¡Œæ¯”è¾ƒï¼Œå¹¶å­¦ä¹ ç”Ÿäº§ç¯å¢ƒçš„æœ€ä½³å®è·µã€‚