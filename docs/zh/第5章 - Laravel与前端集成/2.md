# **ç¬¬5.2ç« ï¼šåˆ›å»ºç®€å•çš„APIè§†å›¾**
**å­¦ä¹ æ—¶é—´ï¼š** 45åˆ†é’Ÿ

---

### **1. ä»»åŠ¡ï¼šå¯è§†åŒ–æ•°æ®**

æˆ‘ä»¬åœ¨ç¬¬2ç« ä¸­çš„APIèƒ½å¤Ÿä»¥JSONæ ¼å¼è¿”å›æ•°æ®ã€‚è¿™å¯¹äºæœºå™¨æ¥è¯´å¾ˆæ£’ï¼Œä½†äººä»¬æ›´å–œæ¬¢åœ¨ç¾è§‚çš„ç½‘é¡µä¸ŠæŸ¥çœ‹ä¿¡æ¯ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åˆ›å»ºä¸¤ä¸ªè¿™æ ·çš„é¡µé¢ï¼š

1.  **æ‰€æœ‰è¡Œæ˜Ÿåˆ—è¡¨** (`/planets`)
2.  **å•ä¸ªè¡Œæ˜Ÿé¡µé¢** (`/planets/{id}`)

ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨â€œè·¯ç”± â†’ æ§åˆ¶å™¨ â†’ è§†å›¾â€ç»„åˆã€‚

> ğŸ’¡ **å¤ªç©ºç±»æ¯”ï¼š**

> æƒ³è±¡ä¸€ä¸‹ï¼ŒAPIè¿”å›çš„JSONæ˜¯åŸå§‹é¥æµ‹æ•°æ®ï¼Œåªæ˜¯ä¸€ä¸²æ•°å­—æµã€‚æˆ‘ä»¬ä»Šå¤©çš„ä»»åŠ¡æ˜¯åœ¨ä»»åŠ¡æ§åˆ¶ä¸­å¿ƒåˆ›å»ºä¸¤ä¸ªå±å¹•ï¼ˆä¸¤ä¸ªâ€œè§†å›¾â€ï¼‰ï¼š

> - **æ¦‚è§ˆå±å¹•ï¼š** æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å¯¹è±¡çš„çŠ¶æ€ï¼ˆè¡Œæ˜Ÿåˆ—è¡¨ï¼‰ã€‚
> - **è¯¦ç»†å±å¹•ï¼š** ç‚¹å‡»å¯¹è±¡æ—¶æ˜¾ç¤ºå…¶æ‰€æœ‰ä¿¡æ¯ï¼ˆå•ä¸ªè¡Œæ˜Ÿé¡µé¢ï¼‰ã€‚

---

### **2. æ­¥éª¤1ï¼šåˆ›å»ºç½‘é¡µæ§åˆ¶å™¨**
ä¸ºäº†æ¶æ„çš„æ¸…æ™°ï¼Œä¸åº”å°†APIé€»è¾‘å’Œç½‘é¡µé€»è¾‘æ··åˆåœ¨åŒä¸€ä¸ªæ§åˆ¶å™¨ä¸­ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æ§åˆ¶å™¨ï¼Œä¸“é—¨ç”¨äºæ˜¾ç¤ºæˆ‘ä»¬çš„Bladeè§†å›¾ã€‚

åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œï¼š
```bash
php artisan make:controller Web/PlanetPageController
```
*æˆ‘ä»¬å°†å…¶åˆ›å»ºåœ¨ `Web` å­æ–‡ä»¶å¤¹ä¸­ï¼Œä»¥ä¾¿ä¸APIæ§åˆ¶å™¨åŒºåˆ†å¼€æ¥ã€‚*

æ‰“å¼€åˆ›å»ºçš„æ–‡ä»¶ `app/Http/Controllers/Web/PlanetPageController.php`ã€‚

---

### **æ­¥éª¤2ï¼šæ‰€æœ‰è¡Œæ˜Ÿåˆ—è¡¨é¡µé¢**
**1. åœ¨æ§åˆ¶å™¨ä¸­åˆ›å»ºæ–¹æ³•ï¼š**
åœ¨ `PlanetPageController` ä¸­æ·»åŠ  `index` æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰è¡Œæ˜Ÿå¹¶å°†å…¶ä¼ é€’ç»™è§†å›¾ã€‚
```php
<?php

namespace App\Http\Controllers\Web;

use App\Http\Controllers\Controller;
use App\Models\Planet; // åˆ«å¿˜äº†å¯¼å…¥æ¨¡å‹

class PlanetPageController extends Controller
{
    /**
     * æ˜¾ç¤ºæ‰€æœ‰è¡Œæ˜Ÿåˆ—è¡¨é¡µé¢ã€‚
     */
    public function index()
    {
        // 1. ä»æ•°æ®åº“ä¸­è·å–æ‰€æœ‰è¡Œæ˜Ÿ
        $planets = Planet::all();

        // 2. è¿”å›è§†å›¾å¹¶ä¼ é€’æ•°æ®
        return view('planets.index', ['planets' => $planets]);
    }
}
```

**2. åˆ›å»ºBladeè§†å›¾ï¼š**
åˆ›å»ºæ–‡ä»¶ `resources/views/planets/index.blade.php`ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä¸Šä¸€ç« ä¸­åˆ›å»ºçš„å¸ƒå±€ã€‚

```html
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¡Œæ˜Ÿ</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 2em;
        }
        .container {
            max-width: 960px;
            margin: 0 auto;
        }
        h2 {
            color: #1a202c;
        }
        hr {
            border: none;
            border-top: 1px solid #e2e8f0;
            margin: 1.5em 0;
        }
        .planet-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5em;
        }
        .planet-card {
            background-color: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 0.5em;
            padding: 1.5em;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s;
        }
        .planet-card:hover {
            transform: translateY(-5px);
        }
        .planet-card h3 {
            margin-top: 0;
            color: #2d3748;
        }
        .planet-card p {
            margin-bottom: 0.5em;
            color: #4a5568;
        }
        .planet-card a {
            color: #4299e1;
            text-decoration: none;
            font-weight: bold;
        }
        .planet-card a:hover {
            text-decoration: underline;
        }
        .no-planets {
            color: #718096;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>æ‰€æœ‰å·²çŸ¥è¡Œæ˜Ÿåˆ—è¡¨</h2>
        <hr>
        <div class="planet-list">
            @forelse($planets as $planet)
                <div class="planet-card">
                    <h3>{{ $planet->name }}</h3>
                    <p>å¤ªé˜³ç³»ï¼š{{ $planet->solar_system }}</p>
                    <p>ç›´å¾„ï¼š{{ number_format($planet->size_km, 0, '.', ' ') }} å…¬é‡Œ</p>
                    <a href="/planets/{{ $planet->id }}">äº†è§£æ›´å¤š &rarr;</a>
                </div>
            @empty
                <p class="no-planets">æ•°æ®åº“ä¸­æ²¡æœ‰è¡Œæ˜Ÿã€‚è¯·è¿è¡Œæ•°æ®å¡«å……å™¨ã€‚</p>
            @endforelse
        </div>
    </div>
</body>
</html>
```

-   `number_format(...)` æ˜¯ä¸€ä¸ªæ™®é€šçš„PHPå‡½æ•°ï¼Œç”¨äºç¾è§‚åœ°æ ¼å¼åŒ–æ•°å­—ã€‚å®ƒå¯ä»¥åœ¨Bladeä¸­ç›´æ¥ä½¿ç”¨ã€‚

**3. åœ¨ `routes/web.php` ä¸­åˆ›å»ºè·¯ç”±ï¼š**
```php
use App\Http\Controllers\Web\PlanetPageController;

// ...

Route::get('/planets', [PlanetPageController::class, 'index']);
```
ç°åœ¨ï¼Œå¦‚æœæ‚¨åœ¨æµè§ˆå™¨ä¸­è®¿é—® `/planets` åœ°å€ï¼Œæ‚¨å°†çœ‹åˆ°è¡Œæ˜Ÿåˆ—è¡¨é¡µé¢ï¼

---

### **4. æ­¥éª¤3ï¼šå•ä¸ªè¡Œæ˜Ÿé¡µé¢**
**1. åœ¨æ§åˆ¶å™¨ä¸­åˆ›å»ºæ–¹æ³•ï¼š**

åœ¨ `PlanetPageController` ä¸­æ·»åŠ  `show` æ–¹æ³•ã€‚é€šè¿‡è·¯ç”±æ¨¡å‹ç»‘å®šï¼ˆRoute Model Bindingï¼‰ï¼ŒLaravelå°†æ ¹æ®IDè‡ªåŠ¨æ‰¾åˆ°è¡Œæ˜Ÿå¹¶å°†å…¶ä¼ é€’ç»™æ–¹æ³•ã€‚

```php
<?php
// åœ¨ PlanetPageController ç±»å†…éƒ¨
/**
 * æ˜¾ç¤ºå•ä¸ªå…·ä½“è¡Œæ˜Ÿçš„é¡µé¢ã€‚
 */
public function show(Planet $planet)
{
    // Laravel å·²ç»ä¸ºæˆ‘ä»¬æ‰¾åˆ°äº†è¡Œæ˜Ÿã€‚
    // å¦‚æœæœªæ‰¾åˆ°ï¼Œå®ƒå°†è‡ªåŠ¨è¿”å› 404 é”™è¯¯ã€‚

    return view('planets.show', ['planet' => $planet]);
}
```

**2. åˆ›å»ºBladeè§†å›¾ï¼š**

åˆ›å»ºæ–‡ä»¶ `resources/views/planets/show.blade.php`ã€‚

```html
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ $planet->name }}</title>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 2em;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            width: 100%;
        }
        .planet-detail {
            background-color: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 0.5em;
            padding: 2em;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .planet-detail h1 {
            margin-top: 0;
            color: #2d3748;
        }
        .planet-detail p {
            margin-bottom: 1em;
            color: #4a5568;
            font-size: 1.1em;
        }
        .back-link {
            display: inline-block;
            margin-top: 1.5em;
            color: #4299e1;
            text-decoration: none;
            font-weight: bold;
        }
        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="planet-detail">
            @if($planet->image_url)
                <img src="{{ $planet->image_url }}" alt="{{ $planet->name }}çš„å›¾ç‰‡" style="max-width: 100%; height: auto; border-radius: 0.5em; margin-bottom: 1em;">
            @endif
            <h1>{{ $planet->name }}</h1>
            @if($planet->description)
                <p>{{ $planet->description }}</p>
            @endif
            <p><strong>å¤ªé˜³ç³»ï¼š</strong> {{ $planet->solar_system }}</p>
            <p><strong>ç›´å¾„ï¼š</strong> {{ number_format($planet->size_km, 0, '.', ' ') }} å…¬é‡Œ</p>
            <a href="/planets" class="back-link">&larr; è¿”å›è¡Œæ˜Ÿåˆ—è¡¨</a>
        </div>
    </div>
</body>
</html>
```

**3. åœ¨ `routes/web.php` ä¸­åˆ›å»ºè·¯ç”±ï¼š**
```php
// åœ¨ /planets è·¯ç”±ä¹‹åæ·»åŠ æ­¤è·¯ç”±
Route::get('/planets/{planet}', [PlanetPageController::class, 'show']);
```
-   å‚æ•°åç§° `{planet}` å¿…é¡»ä¸æ§åˆ¶å™¨æ–¹æ³•ä¸­çš„å˜é‡åç§° (`show(Planet $planet)`) åŒ¹é…ï¼Œä»¥ä¾¿è·¯ç”±æ¨¡å‹ç»‘å®šæ­£å¸¸å·¥ä½œã€‚

ç°åœ¨ï¼Œç‚¹å‡»åˆ—è¡¨é¡µé¢ä¸Šçš„â€œäº†è§£æ›´å¤šâ€é“¾æ¥ï¼Œæ‚¨å°†è¿›å…¥ç‰¹å®šè¡Œæ˜Ÿçš„è¯¦ç»†é¡µé¢ã€‚

---

### **å·©å›ºç»ƒä¹ å°æµ‹éªŒ**


<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. åˆ†ç¦»APIå’Œç½‘é¡µé€»è¾‘çš„æœ€ä½³å®è·µæ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q1" value="a"> a) ä¸ºæ‰€æœ‰å†…å®¹ä½¿ç”¨ä¸€ä¸ªæ§åˆ¶å™¨</label>
      <label><input type="radio" name="q1" value="b"> b) åˆ›å»ºå•ç‹¬çš„æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨`Web`å’Œ`Api`æ–‡ä»¶å¤¹ä¸­ï¼‰</label>
      <label><input type="radio" name="q1" value="c"> c) å°†æ‰€æœ‰é€»è¾‘æ”¾åœ¨è·¯ç”±æ–‡ä»¶ä¸­</label>
    </div>
    <div class="question">
      <p>2. return view('planets.index', ['planets' => $planets]); çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q2" value="a"> a) è¿”å›åŒ…å«è¡Œæ˜Ÿæ•°æ®çš„JSONæ•°ç»„</label>
      <label><input type="radio" name="q2" value="b"> b) æ¸²æŸ“ resources/views/planets/index.blade.php æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¼ é€’ `$planets` å˜é‡</label>
      <label><input type="radio" name="q2" value="c"> c) é‡å®šå‘åˆ° URL /planets/index</label>
    </div>
    <div class="question">
      <p>3. åœ¨ `show(Planet $planet)` çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œè·¯ç”±æ¨¡å‹ç»‘å®šï¼ˆRoute Model Bindingï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q3" value="a"> a) Laravel æ‰‹åŠ¨åœ¨é…ç½®ä¸­å°†è·¯ç”±ä¸æ¨¡å‹ç»‘å®š</label>
      <label><input type="radio" name="q3" value="b"> b) Laravel æ ¹æ®URLä¸­çš„å‚æ•° (`{planet}`) è‡ªåŠ¨åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾ `Planet` è®°å½•</label>
      <label><input type="radio" name="q3" value="c"> c) å¦‚æœæœªæ‰¾åˆ°è¡Œæ˜Ÿï¼ŒLaravel ä¼šåˆ›å»ºä¸€é¢—æ–°è¡Œæ˜Ÿ</label>
    </div>
    <div class="question">
      <p>4. å¦‚ä½•åœ¨Bladeä¸­æ ¼å¼åŒ– `created_at` å­—æ®µçš„æ—¥æœŸï¼Ÿ</p>
      <label><input type="radio" name="q4" value="a"> a) {{ $planet->created_at->format('Y-m-d') }}</label>
      <label><input type="radio" name="q4" value="b"> b) {{ format_date($planet->created_at) }}</label>
      <label><input type="radio" name="q4" value="c"> c) è¿™åªèƒ½åœ¨æ§åˆ¶å™¨ä¸­å®Œæˆ</label>
    </div>
    <div class="question">
      <p>5. å¦‚æœè·¯ç”±ä¸­æŒ‡å®šäº† `/posts/{post}`ï¼Œæ§åˆ¶å™¨ä¸­æ–¹æ³•çš„ç­¾ååº”è¯¥å¦‚ä½•ç¼–å†™æ‰èƒ½ä½¿è·¯ç”±æ¨¡å‹ç»‘å®šï¼ˆRoute Model Bindingï¼‰å·¥ä½œï¼Ÿ</p>
      <label><input type="radio" name="q5" value="a"> a) public function show(Post $post)</label>
      <label><input type="radio" name="q5" value="b"> b) public function show(Post $p)</label>
      <label><input type="radio" name="q5" value="c"> c) public function show($post)</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">æ£€æŸ¥</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'b', q4: 'a', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>ç»“æœï¼š</h4><ul>';
for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:green;">æ­£ç¡®ï¼</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:red;">é”™è¯¯ã€‚</span> æ­£ç¡®ç­”æ¡ˆ: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:orange;">æ²¡æœ‰ç­”æ¡ˆã€‚</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>æ‚¨çš„åˆ†æ•°: ${score} / ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**ğŸš€ æœ¬ç« æ€»ç»“ï¼š**

æ‚¨å·²æˆåŠŸä½¿ç”¨ Laravel MVC æ¶æ„ä¸ºæ‚¨çš„ API åˆ›å»ºäº†â€œå‰ç«¯å±•ç¤ºâ€ã€‚ç°åœ¨æ‚¨æ‹¥æœ‰ï¼š

-   ç”¨äºç½‘é¡µé€»è¾‘çš„ç‹¬ç«‹æ§åˆ¶å™¨ã€‚
-   ä¸€ä¸ªåŠ¨æ€é¡µé¢ï¼Œåˆ—å‡ºæ‰€æœ‰è¡Œæ˜Ÿï¼Œå¹¶ä»æ•°æ®åº“è·å–æ•°æ®ã€‚
-   æ¯ä¸ªè¡Œæ˜Ÿçš„è¯¦ç»†é¡µé¢ï¼Œä½¿ç”¨è·¯ç”±æ¨¡å‹ç»‘å®šï¼ˆRoute Model Bindingï¼‰ã€‚
-   åœ¨ `routes/web.php` ä¸­å®šä¹‰äº†ä¸¤ä¸ª Web è·¯ç”±ï¼Œç”¨äºè®¿é—®è¿™äº›é¡µé¢ã€‚

**æ‚¨å·²å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºç”¨æˆ·å¯ç†è§£ä¸”æœ‰ç”¨çš„ä¿¡æ¯ã€‚** åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡å°† JavaScript åµŒå…¥åˆ°æˆ‘ä»¬çš„ Blade è§†å›¾ä¸­æ¥å¢åŠ äº¤äº’æ€§ï¼Œä»¥å®ç°åœ¨ä¸é‡æ–°åŠ è½½é¡µé¢çš„æƒ…å†µä¸‹ä¸ API è¿›è¡Œäº¤äº’ã€‚