# **ç¬¬5.5ç« ï¼šç½‘é¡µè·¯ç”±**
**å­¦ä¹ æ—¶é—´ï¼š** 40åˆ†é’Ÿ

---

### **1. `routes/web.php` ä¸ `routes/api.php`ï¼šä¸¤ç§ä¸åŒçš„æ§åˆ¶å°**

å†æ¬¡å¼ºè°ƒå®ƒä»¬ä¹‹é—´çš„æ ¹æœ¬åŒºåˆ«è‡³å…³é‡è¦ï¼š

| ç‰¹æ€§          | `routes/web.php` (Web æ§åˆ¶å°)                               | `routes/api.php` (API æ§åˆ¶å°)                                  |
| ----------------------- | ---------------------------------------------------------- | ------------------------------------------------------------- |
| **ä¸»è¦ä»»åŠ¡**     | æ˜¾ç¤º HTML é¡µé¢ï¼Œå¤„ç†è¡¨å•                   | ä»¥ JSON æ ¼å¼ä¸ºå…¶ä»–åº”ç”¨ç¨‹åºæä¾›æ•°æ®     |
| **çŠ¶æ€ (State)**   | **æœ‰çŠ¶æ€** (Stateful) â€” ä½¿ç”¨ä¼šè¯å’Œ Cookie | **æ— çŠ¶æ€** (Stateless) â€” æ¯ä¸ªè¯·æ±‚ç‹¬ç«‹        |
| **é»˜è®¤ä¸­é—´ä»¶** | `web` (åŒ…æ‹¬ä¼šè¯ã€CSRF ä¿æŠ¤ã€Cookie åŠ å¯†) | `api` (åŒ…æ‹¬â€œèŠ‚æµâ€â€”â€”è¯·æ±‚é¢‘ç‡é™åˆ¶) |
| **URL å‰ç¼€**         | æ—  (æ‚¨çš„ç½‘ç«™æ ¹ç›®å½•)                                  | `/api/` (åœ¨ `RouteServiceProvider` ä¸­é…ç½®)              |
| **èº«ä»½éªŒè¯**      | é€šå¸¸é€šè¿‡ä¼šè¯ (ç™»å½•/å¯†ç )                       | é€šå¸¸é€šè¿‡ä»¤ç‰Œ (Sanctum, Passport)                        |

æˆ‘ä»¬ä½¿ç”¨ `routes/web.php` æ¥æ„å»ºä¾›çœŸäººä½¿ç”¨çš„ç•Œé¢ã€‚

---

### **2. ç½‘é¡µèµ„æºè·¯ç”±**

ç±»ä¼¼äº `Route::apiResource`ï¼Œç½‘é¡µä¹Ÿæœ‰ `Route::resource`ã€‚å®ƒä¸ºå®Œæ•´çš„ CRUD å‘¨æœŸåˆ›å»ºè·¯ç”±ï¼ŒåŒ…æ‹¬æ˜¾ç¤ºåˆ›å»ºå’Œç¼–è¾‘è¡¨å•çš„é¡µé¢ã€‚

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®Œæ•´çš„è·¯ç”±é›†ï¼Œé€šè¿‡ Web ç•Œé¢ç®¡ç†æˆ‘ä»¬çš„è¡Œæ˜Ÿã€‚

**æ­¥éª¤ 1ï¼šåœ¨ `routes/web.php` ä¸­åˆ›å»ºè·¯ç”±**

æ³¨é‡Šæˆ–åˆ é™¤ `/planets` çš„æ—§è·¯ç”±ï¼Œå¹¶ç”¨ä¸€è¡Œä»£ç æ›¿æ¢å®ƒä»¬ï¼š

```php
use App\Http\Controllers\Web\PlanetPageController;

// Route::get('/planets', [PlanetPageController::class, 'index']);
// Route::get('/planets/{planet}', [PlanetPageController::class, 'show']);

Route::resource('planets', PlanetPageController::class);
```

**æ­¥éª¤ 2ï¼šæŸ¥çœ‹å·²åˆ›å»ºçš„å†…å®¹**
åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤ `php artisan route:list --except-vendor`ï¼š

```
+--------+-----------+------------------------+------------------+-------------------------------------------------+------------+
| Method | URI       | Name                   | Action           | Middleware                                      |
+--------+-----------+------------------------+------------------+-------------------------------------------------+------------+
| GET|HEAD | planets                | planets.index          | ...\PlanetPageController@index                    | web        |
| POST   | planets                | planets.store          | ...\PlanetPageController@store                    | web        |
| GET|HEAD | planets/create         | planets.create         | ...\PlanetPageController@create                   | web        |
| GET|HEAD | planets/{planet}       | planets.show           | ...\PlanetPageController@show                     | web        |
| PUT|PATCH | planets/{planet}       | planets.update         | ...\PlanetPageController@update                   | web        |
| DELETE | planets/{planet}       | planets.destroy        | ...\PlanetPageController@destroy                  | web        |
| GET|HEAD | planets/{planet}/edit  | planets.edit           | ...\PlanetPageController@edit                     | web        |
+--------+-----------+------------------------+------------------+-------------------------------------------------+------------+
```

`Route::resource` ä¸ºæˆ‘ä»¬åˆ›å»ºäº† 7 æ¡è·¯ç”±ï¼ŒåŒ…æ‹¬ï¼š

-   `planets.create` (GET `/planets/create`): å¸¦æœ‰åˆ›å»ºè¡¨å•çš„é¡µé¢ã€‚
-   `planets.store` (POST `/planets`): å¤„ç†æ­¤è¡¨å•ã€‚
-   `planets.edit` (GET `/planets/{planet}/edit`): å¸¦æœ‰ç¼–è¾‘è¡¨å•çš„é¡µé¢ã€‚
-   `planets.update` (PUT/PATCH `/planets/{planet}`): å¤„ç†ç¼–è¾‘è¡¨å•ã€‚
-   `planets.destroy` (DELETE `/planets/{planet}`): åˆ é™¤èµ„æºã€‚

---

### **3. å‘½åè·¯ç”±ï¼šä¾¿æ·çš„â€œå®‡å®™åæ ‡â€**
è¯·æ³¨æ„ `Name` åˆ—ã€‚Laravel è‡ªåŠ¨ä¸ºæ¯æ¡è·¯ç”±åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„åç§°ï¼ˆä¾‹å¦‚ `planets.index`ï¼‰ã€‚ä½¿ç”¨åç§°è€Œä¸æ˜¯ç¡¬ç¼–ç çš„ URL æ˜¯ä¸€ç§**æœ€ä½³å®è·µ**ã€‚

**ä¸ºä»€ä¹ˆï¼Ÿ** å¦‚æœæ‚¨å†³å®šå°† URL ä» `/planets` æ›´æ”¹ä¸º `/worlds`ï¼Œæ‚¨æ— éœ€åœ¨æ‰€æœ‰æ¨¡æ¿ä¸­æŸ¥æ‰¾å¹¶æ›´æ”¹æ‰€æœ‰é“¾æ¥ã€‚æ‚¨åªéœ€åœ¨ä¸€ä¸ªåœ°æ–¹â€”â€”è·¯ç”±æ–‡ä»¶ä¸­è¿›è¡Œæ›´æ”¹ï¼Œè€Œåç§°ä¿æŒä¸å˜ã€‚

**åœ¨ Blade ä¸­çš„ä½¿ç”¨ç¤ºä¾‹ï¼š**

ä»¥å‰æˆ‘ä»¬è¿™æ ·å†™ï¼š

```blade
<a href="/planets/{{ $planet->id }}">Ğ£Ğ·Ğ½Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ &rarr;</a>
```

ç°åœ¨æˆ‘ä»¬å°†ä½¿ç”¨ `route()` åŠ©æ‰‹å‡½æ•°è¿™æ ·å†™ï¼š
```blade
<a href="{{ route('planets.show', ['planet' => $planet->id]) }}">Ğ£Ğ·Ğ½Ğ°Ñ‚ÑŒ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ &rarr;</a>
```

-   `route('planets.show', ...)` â€” ä¸ºåä¸º `planets.show` çš„è·¯ç”±ç”Ÿæˆ URLã€‚
-   `['planet' => $planet->id]` â€” å°†æ‰€éœ€çš„å‚æ•°ä¼ é€’åˆ° URL ä¸­ã€‚Laravel ä¼šè‡ªåŠ¨å°† ID æ›¿æ¢åˆ° `{planet}` ä¸­ã€‚ç”šè‡³å¯ä»¥ä¼ é€’æ•´ä¸ªæ¨¡å‹ï¼š`['planet' => $planet]`ã€‚

---

### **4. å®ç°æ§åˆ¶å™¨ä¸­ç¼ºå¤±çš„æ–¹æ³•**
`Route::resource` åˆ›å»ºäº†è·¯ç”±ï¼Œä½† `PlanetPageController` ä¸­ç›¸åº”çš„æ–¹æ³•éœ€è¦æˆ‘ä»¬è‡ªå·±åˆ›å»ºã€‚

æ‰“å¼€ `app/Http/Controllers/Web/PlanetPageController.php` å¹¶æ·»åŠ å®ƒä»¬ã€‚

```php
<?php
use Illuminate\Http\Request; // <-- æ·»åŠ 

class PlanetPageController extends Controller
{
    // æˆ‘ä»¬å·²ç»æœ‰äº† index() å’Œ show()

    /**
     * æ˜¾ç¤ºåˆ›å»ºæ–°è¡Œæ˜Ÿçš„è¡¨å•ã€‚
     */
    public function create()
    {
        return view('planets.create'); // åªéœ€è¿”å›å¸¦æœ‰è¡¨å•çš„è§†å›¾
    }

    /**
     * å°†æ–°è¡Œæ˜Ÿä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚
     */
    public function store(Request $request)
    {
        // éªŒè¯è¡¨å•æ•°æ®
        $validated = $request->validate([
            'name' => 'required|string|max:255|unique:planets',
            'solar_system' => 'required|string|max:100',
            // ... å…¶ä»–è§„åˆ™
        ]);

        Planet::create($validated);

        // å°†ç”¨æˆ·é‡å®šå‘åˆ°å¸¦æœ‰æˆåŠŸæ¶ˆæ¯çš„åˆ—è¡¨é¡µé¢
        return redirect()->route('planets.index')->with('success', 'ĞŸĞ»Ğ°Ğ½ĞµÑ‚Ğ° ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ°!');
    }

    /**
     * æ˜¾ç¤ºç¼–è¾‘è¡Œæ˜Ÿçš„è¡¨å•ã€‚
     */
    public function edit(Planet $planet)
    {
        return view('planets.edit', ['planet' => $planet]);
    }

    /**
     * æ›´æ–°æ•°æ®åº“ä¸­çš„è¡Œæ˜Ÿæ•°æ®ã€‚
     */
    public function update(Request $request, Planet $planet)
    {
        $validated = $request->validate([
            'name' => 'required|string|max:255|unique:planets,name,' . $planet->id,
            'solar_system' => 'required|string|max:100',
        ]);

        $planet->update($validated);

        return redirect()->route('planets.show', $planet)->with('success', 'Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¾ Ğ¿Ğ»Ğ°Ğ½ĞµÑ‚Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹!');
    }

    /**
     * åˆ é™¤è¡Œæ˜Ÿã€‚
     */
    public function destroy(Planet $planet)
    {
        $planet->delete();

        return redirect()->route('planets.index')->with('success', 'ĞŸĞ»Ğ°Ğ½ĞµÑ‚Ğ° ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ°.');
    }
}
```

-   `redirect()->route(...)` â€” å°†ç”¨æˆ·é‡å®šå‘åˆ°å¦ä¸€ä¸ªå‘½åè·¯ç”±ã€‚
-   `->with('success', '...')` â€” åœ¨ä¼šè¯ä¸­æ·»åŠ â€œé—ªå­˜æ¶ˆæ¯â€ï¼Œè¯¥æ¶ˆæ¯å°†åœ¨ä¸‹ä¸€é¡µä¸Šä»…å¯ç”¨ä¸€æ¬¡ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ Blade æ¨¡æ¿ä¸­æ˜¾ç¤ºå®ƒã€‚

---

### **5. è·¯ç”±åˆ†ç»„**
å¦‚æœæ‚¨æœ‰è®¸å¤šå…·æœ‰å…±åŒç‰¹å¾çš„è·¯ç”±ï¼ˆä¾‹å¦‚ï¼Œå®ƒä»¬éƒ½ç”¨äºç®¡ç†é¢æ¿ï¼Œå¹¶ä¸”åº”å…·æœ‰ `/admin` å‰ç¼€å’Œç‰¹æ®Šçš„ä¸­é—´ä»¶ï¼‰ï¼Œåˆ™å¯ä»¥å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„ã€‚

```php
<?php
Route::middleware(['auth', 'admin'])->prefix('admin')->name('admin.')->group(function () {
    // æ­¤ç»„å†…çš„æ‰€æœ‰è·¯ç”±å°†å…·æœ‰ï¼š
    // 1. 'auth' å’Œ 'admin' ä¸­é—´ä»¶
    // 2. URL å‰ç¼€ '/admin' (ä¾‹å¦‚, /admin/planets)
    // 3. åç§°å‰ç¼€ 'admin.' (ä¾‹å¦‚, admin.planets.index)

    Route::resource('planets', PlanetPageController::class);
    // Route::get('/dashboard', ...)->name('dashboard'); // -> admin.dashboard
});
```

---

### **å·©å›ºçŸ¥è¯†å°æµ‹éªŒ**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. åœ¨ `routes/web.php` ä¸­ï¼Œå“ªä¸ªå‘½ä»¤å°†ä¸º Web ç•Œé¢åˆ›å»ºä¸€å¥—å®Œæ•´çš„ CRUD è·¯ç”±ï¼Ÿ</p>
      <label><input type="radio" name="q1" value="a"> a) Route::crud('planets', Controller::class)</label>
      <label><input type="radio" name="q1" value="b"> b) Route::apiResource('planets', Controller::class)</label>
      <label><input type="radio" name="q1" value="c"> c) Route::resource('planets', Controller::class)</label>
    </div>
    <div class="question">
      <p>2. ä½¿ç”¨å‘½åè·¯ç”±çš„ä¸»è¦ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q2" value="a"> a) å®ƒä»¬æ¯”ç›´æ¥ URL è¿è¡Œæ›´å¿«</label>
      <label><input type="radio" name="q2" value="b"> b) å…è®¸è½»æ¾æ›´æ”¹è·¯ç”±æ–‡ä»¶ä¸­çš„ URLï¼Œè€Œä¸ä¼šç ´åæ¨¡æ¿ä¸­çš„é“¾æ¥</label>
      <label><input type="radio" name="q2" value="c"> c) å®ƒä»¬è‡ªåŠ¨å—åˆ° CSRF ä¿æŠ¤</label>
    </div>
    <div class="question">
      <p>3. å¯¹äº `Route::resource('articles', ...)` ä¸­çš„ `create()` æ–¹æ³•ï¼Œå°†ç”Ÿæˆå“ªä¸ªè·¯ç”±ï¼Ÿ</p>
      <label><input type="radio" name="q3" value="a"> a) GET `/articles/new`</label>
      <label><input type="radio" name="q3" value="b"> b) GET `/articles/create`</label>
      <label><input type="radio" name="q3" value="c"> c) POST `/articles/create`</label>
    </div>
    <div class="question">
      <p>4. ä»£ç  `redirect()->route('home')->with('status', 'OK')` çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q4" value="a"> a) åœ¨ URL `/home` è¿”å›å¸¦æœ‰ 'status' => 'OK' çš„ JSON</label>
      <label><input type="radio" name="q4" value="b"> b) é‡å®šå‘åˆ°åä¸º `home` çš„è·¯ç”±ï¼Œå¹¶å‘ä¼šè¯æ·»åŠ ä¸€æ¬¡æ€§æ¶ˆæ¯ 'status'</label>
      <label><input type="radio" name="q4" value="c"> c) æ˜¾ç¤ºå¸¦æœ‰å˜é‡ `$status` çš„ `home.blade.php` è§†å›¾</label>
    </div>
    <div class="question">
      <p>5. `Route::prefix('dashboard')` çš„ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿ</p>
      <label><input type="radio" name="q5" value="a"> a) ç”¨äºä¸ºç»„å†…çš„æ‰€æœ‰ URL æ·»åŠ å‰ç¼€</label>
      <label><input type="radio" name="q5" value="b"> b) ç”¨äºä¸ºç»„å†…çš„æ‰€æœ‰è·¯ç”±åç§°æ·»åŠ å‰ç¼€</label>
      <label><input type="radio" name="q5" value="c"> c) ç”¨äºåº”ç”¨ `dashboard` ä¸­é—´ä»¶</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">æ£€æŸ¥</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'c', q2: 'b', q3: 'b', q4: 'b', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>ç»“æœï¼š</h4><ul>';
</script>
for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:green;">æ­£ç¡®ï¼</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:red;">é”™è¯¯ã€‚</span> æ­£ç¡®ç­”æ¡ˆ: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>é—®é¢˜ ${question.slice(1)}: <span style="color:orange;">æœªä½œç­”ã€‚</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>æ‚¨çš„åˆ†æ•°ï¼š${score} / ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**ğŸš€ æœ¬ç« æ€»ç»“ï¼š**

æ‚¨å·²æŒæ¡åœ¨ Laravel ä¸­ç»„ç»‡ Web è·¯ç”±çš„ç»“æ„åŒ–å’Œä¸“ä¸šæ–¹æ³•ã€‚ç°åœ¨æ‚¨èƒ½å¤Ÿï¼š

-   åŒºåˆ† `web` å’Œ `api` è·¯ç”±åŠå…¶ç”¨é€”ã€‚
-   ä½¿ç”¨ `Route::resource` å¿«é€Ÿç”Ÿæˆæ ‡å‡† CRUD è·¯ç”±ã€‚
-   åº”ç”¨å‘½åè·¯ç”±æ¥åˆ›å»ºçµæ´»ä¸”å¯ç»´æŠ¤çš„ä»£ç ã€‚
-   åœ¨æ§åˆ¶å™¨ä¸­åˆ›å»ºå®Œæ•´çš„ CRUD æ“ä½œï¼ŒåŒ…æ‹¬éªŒè¯å’Œé‡å®šå‘ã€‚
-   åˆ†ç»„è·¯ç”±ä»¥åº”ç”¨é€šç”¨è§„åˆ™ã€‚

**æ‚¨â€œé£èˆ¹â€çš„å¯¼èˆªç³»ç»Ÿç°åœ¨å·²å…·å¤‡å®¹é”™æ€§ï¼Œå¹¶å‡†å¤‡å¥½è¿›è¡Œæ‰©å±•ã€‚** åœ¨æœ¬èŠ‚çš„æœ€åä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ•´åˆæ‰€æœ‰è·å¾—çš„çŸ¥è¯†ï¼Œå¹¶åœ¨æˆ‘ä»¬çš„ Blade é¡µé¢ä¸Šæ˜¾ç¤ºé€šè¿‡ Fetch è·å–çš„è¡Œæ˜Ÿæ•°æ®ã€‚