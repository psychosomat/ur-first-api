# **Cap√≠tulo 5.1: Modelos Blade no Laravel**
**Tempo de estudo:** 40 minutos

---

### **1. O que √© Blade? Seu "projeto" inteligente**

At√© agora, trabalhamos com dois extremos: um `index.html` puro e uma resposta JSON pura de uma API. Mas como criar p√°ginas web completas que exibem dados dinamicamente do nosso backend?

**Blade** ‚Äî √© o motor de templates integrado do Laravel. Ele nos permite escrever HTML comum, mas com "superpoderes":

-   Inserir vari√°veis e executar c√≥digo PHP com uma sintaxe elegante.
-   Criar "layouts" de p√°ginas reutiliz√°veis (cabe√ßalhos, rodap√©s).
-   Usar loops e condi√ß√µes diretamente no c√≥digo HTML.
-   Proteger automaticamente contra ataques XSS.

> üí° **Analogia espacial:**

> Imagine que HTML √© um projeto simples de uma nave espacial. Blade √© um sistema CAD avan√ßado. Voc√™ n√£o apenas desenha linhas, voc√™ adiciona objetos "inteligentes". Voc√™ diz: "Aqui estar√° a lista da tripula√ß√£o", e Blade automaticamente solicita os dados e os preenche. "Aqui estar√° a tela principal", e Blade insere a interface padr√£o.

Todos os arquivos Blade t√™m a extens√£o `.blade.php` e s√£o armazenados na pasta `resources/views/`.

---

### **2. Fundamentos da Sintaxe: Exibi√ß√£o de Dados**
A coisa mais simples que o Blade faz √© exibir dados.

**Sintaxe `{{ }}`**

Estas chaves duplas s√£o o comando para o Blade "pegar uma vari√°vel e exibir seu conte√∫do de forma segura".

**Exemplo:**

1.  **Rota em `routes/web.php`:**
    ```php
	<?php
    Route::get('/mission-briefing', function () {
        $mission = 'Explorar o sistema Kepler-186';
        return view('briefing', ['mission_name' => $mission]);
    });
    ```

    -   `view('briefing', ...)` diz ao Laravel para encontrar o arquivo `resources/views/briefing.blade.php`.
    -   `['mission_name' => $mission]` ‚Äî √© um array de dados que "passamos" para nossa view.

2.  **View em `resources/views/briefing.blade.php`:**
    ```html
    <h1>Miss√£o Centro de Comando</h1>
    <p>Tarefa atual: {{ $mission_name }}</p>
    ```

**Resultado no navegador em `/mission-briefing`:**
```html
<h1>Miss√£o Centro de Comando</h1>
<p>Tarefa atual: Explorar o sistema Kepler-186</p>
```

> üõ°Ô∏è **Importante saber:** Blade escapa automaticamente todos os dados dentro de `{{ }}`. Isso significa que, se uma vari√°vel contiver tags HTML ou um script malicioso, eles ser√£o exibidos como texto comum, e n√£o executados. Esta √© uma prote√ß√£o integrada contra ataques XSS.

> *Para exibir HTML n√£o escapado (fa√ßa isso com cautela!) usa-se a sintaxe `{!! $variable !!}`.*

---

### **3. Diretivas: Adicionando L√≥gica ao HTML**
As diretivas Blade come√ßam com o s√≠mbolo `@`. Elas permitem usar loops, condi√ß√µes e muito mais.

**Condi√ß√µes (`@if`, `@else`):**
```js
@if($planet->is_habitable)
    <p style="color: green;">Planeta habit√°vel!</p>
@else
    <p style="color: red;">Requer traje espacial. Atmosfera hostil.</p>
@endif
```

**Loops (`@foreach`, `@forelse`):**

`@forelse` ‚Äî √© uma diretiva muito conveniente que combina um loop e uma verifica√ß√£o de vazio.
```js
<h2>Lista de planetas no sistema:</h2>
<ul>
    @forelse($planets as $planet)
        <li>
            {{ $loop->iteration }}. {{ $planet->name }}
            <!-- $loop - vari√°vel especial dispon√≠vel no loop -->
        </li>
    @empty
        <li>Nenhum planeta foi detectado neste sistema.</li>
    @endforelse
</ul>
```

---

### **4. Layouts e Se√ß√µes: N√£o Se Repita (DRY)**
A funcionalidade mais poderosa do Blade √© a cria√ß√£o de layouts reutiliz√°veis. Voc√™ n√£o precisa copiar o cabe√ßalho e o rodap√© do site para cada p√°gina.

**Passo 1: Criar um layout mestre (`layout`)**

Crie o arquivo `resources/views/layouts/app.blade.php`:
```php
<?php
<!DOCTYPE html>
<html lang="pt">
<head>
    <title>Centro de Comando - @yield('title')</title>
    <link rel="stylesheet" href="{{ asset('css/style.css') }}">
</head>
<body>
    <header>
        <h1>Centro de Comando da Frota Gal√°ctica</h1>
    </header>

    <main>
        @yield('content') <!-- O conte√∫do exclusivo da p√°gina vir√° aqui -->
    </main>

    <footer>
        <p>&copy; {{ date('Y') }} Space Command. Todos os direitos reservados.</p>
    </footer>
</body>
</html>
```
-   `@yield('title')` e `@yield('content')` ‚Äî s√£o "slots" ou "marcadores de posi√ß√£o".

**Passo 2: Criar uma view filha que usa o layout**

Crie o arquivo `resources/views/planets/index.blade.php`:
```php
<?php
@extends('layouts.app') {{-- Herdamos nosso layout mestre --}}

@section('title', 'Lista de planetas') {{-- Preenchemos a se√ß√£o 'title' --}}

@section('content') {{-- Preenchemos a se√ß√£o principal 'content' --}}
    <h2>Planetas Registrados</h2>
    <p>Esta √© uma lista de todos os mundos conhecidos por n√≥s.</p>
    {{-- Seu loop @forelse para exibir planetas pode vir aqui --}}
@endsection
```

Agora, quando o Laravel renderizar `planets.index`, ele primeiro pegar√° `layouts.app` e ent√£o inserir√° o conte√∫do das se√ß√µes `@section` nele.

---

### **Quiz para Fixa√ß√£o**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. Qual √© a extens√£o dos arquivos de template Blade?</p>
      <label><input type="radio" name="q1" value="a"> a) .html</label>
      <label><input type="radio" name="q1" value="b"> b) .blade.php</label>
      <label><input type="radio" name="q1" value="c"> c) .php.blade</label>
    </div>
    <div class="question">
      <p>2. Como exibir com seguran√ßa a vari√°vel `$name` no Blade?</p>
      <label><input type="radio" name="q2" value="a"> a) <?php echo $name; ?></label>
      <label><input type="radio" name="q2" value="b"> b) {{ $name }}</label>
      <label><input type="radio" name="q2" value="c"> c) [[$name]]</label>
    </div>
    <div class="question">
      <p>3. Qual diretiva √© usada para herdar um layout mestre?</p>
      <label><input type="radio" name="q3" value="a"> a) @include('layouts.app')</label>
      <label><input type="radio" name="q3" value="b"> b) @layout('layouts.app')</label>
      <label><input type="radio" name="q3" value="c"> c) @extends('layouts.app')</label>
    </div>
    <div class="question">
      <p>4. O que a diretiva `@yield('content')` faz?</p>
      <label><input type="radio" name="q4" value="a"> a) Define um placeholder (local para inserir conte√∫do)</label>
      <label><input type="radio" name="q4" value="b"> b) Insere o conte√∫do do arquivo `content.blade.php`</label>
      <label><input type="radio" name="q4" value="c"> c) Finaliza a se√ß√£o de conte√∫do</label>
    </div>
    <div class="question">
      <p>5. Qual diretiva √© ideal para iterar sobre um array que pode estar vazio?</p>
      <label><input type="radio" name="q5" value="a"> a) @foreach</label>
      <label><input type="radio" name="q5" value="b"> b) @while</label>
      <label><input type="radio" name="q5" value="c"> c) @forelse</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Verificar</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'a', q5: 'c' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Resultados:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:green;">Correto!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:red;">Incorreto.</span> Resposta correta: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Quest√£o ${question.slice(1)}: <span style="color:orange;">Sem resposta.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Seu resultado: ${score} de ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**üöÄ Resumo do Cap√≠tulo:**

Voc√™ aprendeu os fundamentos do Blade ‚Äî uma ferramenta poderosa para criar p√°ginas web din√¢micas. Agora voc√™ sabe:

-   Exibir dados com prote√ß√£o autom√°tica contra XSS.
-   Usar diretivas para adicionar l√≥gica (`@if`, `@forelse`).
-   Criar layouts reutiliz√°veis usando `@extends` e `@yield`.
**N√≥s preparamos "projetos" para os pain√©is de controle da nossa nave.** No pr√≥ximo cap√≠tulo, n√≥s criaremos "pain√©is" (vis√µes) espec√≠ficos para a nossa API e exibiremos dados reais neles.