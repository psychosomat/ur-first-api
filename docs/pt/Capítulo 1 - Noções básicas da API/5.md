# **Cap√≠tulo 1.5: Teste de API com Postman**
**Tempo de estudo:** 50 minutos

---

#### **1. Por que testar APIs? Verifica√ß√£o Pr√©-lan√ßamento**
Imagine: antes de lan√ßar um foguete, os engenheiros realizam **testes de ativa√ß√£o dos sistemas**. Pule a verifica√ß√£o ‚Äî e a miss√£o pode falhar!

**Teste de API** ‚Äî seus testes de controle:

- ‚úÖ Verificar a operacionalidade dos "n√≥s de acoplamento"

- üõ°Ô∏è Detectar vulnerabilidades antes do uso em combate

- üìä Garantir que os dados sejam transmitidos sem distor√ß√µes

> üí° **Analogia espacial:**
> Postman ‚Äî como um console de teste do Centro de Controle de Miss√µes (CCM) para simular todos os cen√°rios: "E se solicitarmos dados de um planeta inexistente? O servidor aguentar√° 1000 requisi√ß√µes/seg?"

---

#### **2. Postman: "Centro de Controle de Voos" para API**
**Funcionalidades:**

- üì° Envio de quaisquer requisi√ß√µes HTTP (GET, POST, PUT, DELETE)

- üîç An√°lise de respostas (c√≥digos de status, cabe√ßalhos, corpo JSON)

- üß™ Escrita de testes autom√°ticos (JavaScript)

- üåê Trabalho com vari√°veis de ambiente (teste vs produ√ß√£o)

[üëâ Baixar Postman](https://www.postman.com/downloads/)

---

#### **3. Primeira execu√ß√£o: Testando a API de planetas**
**Passo 1: Criar uma requisi√ß√£o**

1. Abrir Postman ‚Üí New ‚Üí Request

2. Inserir URL: `https://api.spacexdata.com/v4/rockets`

3. Selecionar m√©todo: **GET**

**Passo 2: Enviar o "sinal"**
```bash
[CCM] -- GET /planetas --> [Servidor SpaceX]
```

**Passo 3: Analisar a telemetria:**
- Status: `200 OK`
- Corpo da resposta (JSON): lista de foguetes com par√¢metros
```json
[
  {
    "name": "Falcon 1",
    "type": "rocket",
    "active": false,
    "stages": 2,
    "id": "5e9d0d95eda69955f709d1eb"
  },
  {
    "name": "Falcon 9",
    "type": "rocket",
    "active": true,
    "id": "5e9d0d95eda69973a809d1ec"
  }
]
```

---

#### **4. Diagrama: Componentes do Postman**
```
[Espa√ßo de trabalho]
‚îú‚îÄ‚îÄ Aba "Params" (Par√¢metros de consulta)
‚îú‚îÄ‚îÄ Aba "Headers" (Cabe√ßalhos)
‚îú‚îÄ‚îÄ Aba "Body" (Corpo da requisi√ß√£o para POST/PUT)
‚îú‚îÄ‚îÄ Aba "Tests" (Scripts para verifica√ß√µes)
‚îî‚îÄ‚îÄ Painel de resposta (Status, Time, Size, Body)
```

---

#### **5. Criar um cen√°rio complexo: Lan√ßamento de miss√£o**
**Teste: Adicionar um novo planeta ao cat√°logo**

1. M√©todo: **POST**

2. URL: `https://jsonplaceholder.typicode.com/posts` (exemplo)

3. Em Headers:
   ```json
	{ "Content-Type": "application/json" }
   ```
4. Em Body (raw ‚Üí JSON):
   ```json
   {
	"title": "New Exoplanet Found",
	"body": "Proxima Centauri b shows signs of a stable atmosphere.",
	"userId": 1
	}
   ```

**Verifica√ß√£o autom√°tica em Tests:**
```javascript
// Verifica√ß√£o de status
pm.test("Post created successfully", () => {
    pm.response.to.have.status(201);
});

// Verifica√ß√£o da estrutura e dados da resposta
pm.test("Response contains the new post data", () => {
    const response = pm.response.json();
    pm.expect(response).to.have.property("id"); // Verifica se o servidor atribuiu um ID
    pm.expect(response.title).to.eql("New Exoplanet Found");
});
```

---

#### **6. Vari√°veis de ambiente: Terra vs Marte**

Como testar em diferentes servidores (teste/produ√ß√£o)?

1. Crie ambientes:
   - `Local` ‚Üí `http://localhost:3000`
   - `Production` ‚Üí `https://api.nasa.gov`

2. Nas requisi√ß√µes, use vari√°veis:
   ```bash
   {{base_url}}/planetas  # Ir√° substituir pela URL atual
   ```

> ‚ö†Ô∏è **Importante!** Nunca teste `DELETE` em um servidor de produ√ß√£o!

---

#### **7. Cole√ß√µes: Biblioteca de miss√µes espaciais**
Agrupe as requisi√ß√µes:
```
	üìÇ Cole√ß√£o "NASA"
  	‚îú‚îÄ‚îÄ GET Planetas
  	‚îú‚îÄ‚îÄ POST Novo planeta
  	‚îî‚îÄ‚îÄ DELETE Planeta (modo de teste)
```
**Vantagens:**

- üöÄ Execu√ß√£o de todos os testes com um √∫nico bot√£o
- üì§ Exporta√ß√£o/importa√ß√£o de configura√ß√µes
- üë®‚ÄçüöÄ Colabora√ß√£o em equipe

---

#### **8. Automa√ß√£o: Verifica√ß√µes regulares de sat√©lites**

Configure o **monitoramento de API** atrav√©s do Postman:

1. Schedule ‚Üí A cada 2 horas

2. Testes:
   ```javascript
   pm.test("Sat√©lite online", () => {
     pm.response.to.have.status(200);
     pm.expect(pm.response.json().signal).above(50); // Sinal >50%
   });
   ```

3. Notifica√ß√µes no Slack/e-mail em caso de falha

---

#### **Question√°rio para fixa√ß√£o**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. Postman √© usado para:</p>
      <label><input type="radio" name="q1" value="a"> a) Enviar e-mail</label>
      <label><input type="radio" name="q1" value="b"> b) Testar APIs</label>
      <label><input type="radio" name="q1" value="c"> c) Criar bancos de dados</label>
    </div>
    <div class="question">
      <p>2. Qual status esperar ao criar um objeto com sucesso?</p>
      <label><input type="radio" name="q2" value="a"> a) 200 OK</label>
      <label><input type="radio" name="q2" value="b"> b) 201 Created</label>
      <label><input type="radio" name="q2" value="c"> c) 404 Not Found</label>
    </div>
    <div class="question">
      <p>3. Onde escrever testes autom√°ticos no Postman?</p>
      <label><input type="radio" name="q3" value="a"> a) Aba "Body"</label>
      <label><input type="radio" name="q3" value="b"> b) Aba "Tests"</label>
      <label><input type="radio" name="q3" value="c"> c) Aba "Cookies"</label>
    </div>
    <div class="question">
      <p>4. Vari√°veis de ambiente s√£o necess√°rias para:</p>
      <label><input type="radio" name="q4" value="a"> a) Alternar entre o servidor de teste e o de produ√ß√£o</label>
      <label><input type="radio" name="q4" value="b"> b) Armazenar senhas em texto claro</label>
      <label><input type="radio" name="q4" value="c"> c) Gerar dados aleat√≥rios</label>
    </div>
    <div class="question">
      <p>5. O que as monitorias regulares verificam?</p>
      <label><input type="radio" name="q5" value="a"> a) Estabilidade do funcionamento da API</label>
      <label><input type="radio" name="q5" value="b"> b) Velocidade da internet</label>
      <label><input type="radio" name="q5" value="c"> c) Atualidade da documenta√ß√£o</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Verificar</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'b', q4: 'a', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Resultados:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:green;">Correto!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:red;">Incorreto.</span> Resposta correta: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Pergunta ${question.slice(1)}: <span style="color:orange;">Sem resposta.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Seu resultado: ${score} de ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>


---

**üöÄ Resumo do cap√≠tulo:**
Postman ‚Äî seu "console de controle" universal para testar APIs. Com ele voc√™ ir√°:
- Verificar o funcionamento dos "sistemas de bordo" antes do lan√ßamento
- Criar uma biblioteca de cen√°rios de teste
- Automatizar o monitoramento de servi√ßos espaciais

> **üìå Tarefa pr√°tica:**

> 1. Instale o Postman
> 2. Crie uma requisi√ß√£o para a API da SpaceX: `GET https://api.spacexdata.com/v4/launches/latest`
> 3. Escreva um teste que verifique que:
>    - O status da resposta √© `200`
>    - O campo `name` cont√©m a palavra "Falcon"
>    - O tempo de resposta √© < 500 ms

**Parab√©ns pela conclus√£o do Cap√≠tulo 1!**

Voc√™ dominou os fundamentos do trabalho com APIs. Nos pr√≥ximos cap√≠tulos, construiremos nossa pr√≥pria "nave espacial" ‚Äî uma aplica√ß√£o web que usa APIs espaciais!

> **üåå Recursos adicionais:**

> - [Documenta√ß√£o da API SpaceX](https://docs.spacexdata.com/)