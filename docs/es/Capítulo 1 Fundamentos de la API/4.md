# **Cap√≠tulo 1.4: Estructura de la API REST**
**Tiempo de estudio:** 45 minutos

---

#### **1. API REST: Arquitectura de una estaci√≥n espacial**
Imagina una estaci√≥n espacial donde cada m√≥dulo tiene:

- **Puerto de acoplamiento est√°ndar** (interfaz √∫nica)

- **Especializaci√≥n clara** (m√≥dulo de vivienda, laboratorio, almac√©n)

- **Sistema de coordenadas** (ubicaci√≥n precisa)

La API **REST (Representational State Transfer)** funciona bajo los mismos principios:

- Interfaz √∫nica para todos los recursos

- Separaci√≥n clara de componentes

- Direccionamiento a trav√©s de URI (coordenadas espaciales)

> üí° **Idea clave:**

> Cada recurso (planetas, cohetes, astronautas) tiene una URL √∫nica e interact√∫a a trav√©s de m√©todos HTTP.

---

#### **2. 6 principios REST en la analog√≠a espacial**
| Principio REST          | An√°logo en la ISS                    | Significado para la API                     |
|-----------------------|----------------------------------|--------------------------------------|
| **Interfaz uniforme**  | Nodos de acoplamiento est√°ndar     | Mismas reglas para todas las solicitudes |
| **Sin estado**         | Cada comando es autosuficiente    | El servidor no almacena el estado del cliente   |
| **Almacenamiento en cach√©**       | Reservas locales de provisiones        | Almacenamiento de respuestas frecuentes            |
| **Cliente-servidor**     | Clara separaci√≥n: Centro de Control ‚Üî Estaci√≥n | Desarrollo independiente de componentes     |
| **Sistema en capas**  | Sat√©lites repetidores           | Proxies, equilibradores de carga      |
| **C√≥digo bajo demanda** | Descarga de software para experimentos    | (Opcional) Transferencia de scripts      |

---

#### **3. Recursos y URI: Coordenadas espaciales**
Cada objeto en la API es un recurso con una direcci√≥n √∫nica:
```
https://api.spacexdata.com/v4/    ‚Üê URL base
          rockets/            ‚Üê Colecci√≥n de cohetes
          rockets/5e9d0d95eda69973a809d1ec ‚Üê Cohete espec√≠fico (por ID)
```

**Ejemplos de recursos espaciales:**

- `GET /stars` ‚Üí Lista de estrellas
- `GET /stars/sirius` ‚Üí Datos sobre Sirio
- `POST /satellites` ‚Üí Lanzar un nuevo sat√©lite
- `PUT /missions/artemis` ‚Üí Actualizar misi√≥n

**Esquema de jerarqu√≠a URI:**
```
[URL base]
‚îú‚îÄ‚îÄ /planets          ‚Üí Colecci√≥n de planetas
‚îÇ   ‚îú‚îÄ‚îÄ /mars         ‚Üí Recurso "Marte"
‚îÇ   ‚îî‚îÄ‚îÄ /venus        ‚Üí Recurso "Venus"
‚îî‚îÄ‚îÄ /launches         ‚Üí Colecci√≥n de lanzamientos
    ‚îú‚îÄ‚îÄ /upcoming     ‚Üí Subcolecci√≥n
    ‚îî‚îÄ‚îÄ /latest       ‚Üí Recurso
```

---

#### **4. Operaciones CRUD a trav√©s de m√©todos HTTP**
| Operaci√≥n | M√©todo HTTP | Ejemplo (Estaci√≥n espacial)     | Respuesta del servidor |
|----------|------------|----------------------------------|---------------|
| **Crear** | `POST`   | Enviar nuevo m√≥dulo           | `201 Created` |
| **Leer**   | `GET`    | Solicitar datos sobre un m√≥dulo        | `200 OK`      |
| **Actualizar** | `PUT`    | Reconfigurar m√≥dulo       | `200 OK`      |
| **Eliminar** | `DELETE` | Desacoplar m√≥dulo antiguo        | `204 No Content` |

**‚ö° Ejemplo de c√≥digo (Adici√≥n de un sat√©lite):**
```python
import requests

# Usamos un servicio de prueba que simula la creaci√≥n de un recurso
new_post = {
    "title": "New Telescope Launch",
    "body": "Hubble-2 is ready for deployment.",
    "userId": 1
}

# Clave API condicional para demostrar los encabezados
headers = {
    "Authorization": "Bearer YOUR_DEMO_KEY",
    "Content-Type": "application/json; charset=UTF-8"
}

response = requests.post(
    "https://jsonplaceholder.typicode.com/posts",
    json=new_post,
    headers=headers
)

if response.status_code == 201:
    print("‚úÖ ¬°Publicaci√≥n sobre el nuevo sat√©lite creada con √©xito!")
    print("Respuesta del servidor:")
    print(response.json())
else:
    print(f"‚ùå ¬°Error! Estado: {response.status_code}")
```

---

#### **5. Versionado de API: Evoluci√≥n de la estaci√≥n**
As√≠ como la ISS se actualiza (M√≥dulo "Zarya" ‚Üí "Nauka"), la API cambia de versi√≥n:

- En la URL: `https://api.spacex.com/v4/rockets`
- En los encabezados: `Accept: application/vnd.spacex-v5+json`

**Por qu√© es importante:**

- v1: Funcionalidad b√°sica
- v2: Campos nuevos a√±adidos
- v3: Estructura de respuestas modificada

> ‚ö†Ô∏è **Consejo:** ¬°Siempre especifica la versi√≥n en las solicitudes, de lo contrario el "acoplamiento" podr√≠a fallar!

---

#### **6. Hipermedia (HATEOAS): Navegaci√≥n en el espacio**
La respuesta de la API contiene enlaces a recursos relacionados, como un mapa de la estaci√≥n:
```json
{
  "id": "iss",
  "name": "Estaci√≥n Espacial Internacional",
  "crew": 7,
  "_links": {
    "self": { "href": "/stations/iss" },
    "modules": { "href": "/stations/iss/modules" },
    "schedule": { "href": "/stations/iss/schedule" }
  }
}
```

---

#### Cuestionario de repaso


<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. REST se expande como:</p>
      <label><input type="radio" name="q1" value="a"> a) Rocket Engine System Transfer</label>
      <label><input type="radio" name="q1" value="b"> b) Representational State Transfer</label>
      <label><input type="radio" name="q1" value="c"> c) Remote Space Technology</label>
    </div>
    <div class="question">
      <p>2. El principio "Stateless" significa:</p>
      <label><input type="radio" name="q2" value="a"> a) El servidor almacena el historial de solicitudes</label>
      <label><input type="radio" name="q2" value="b"> b) Cada solicitud es autosuficiente</label>
      <label><input type="radio" name="q2" value="c"> c) Los datos se transmiten solo a trav√©s de SSL</label>
    </div>
    <div class="question">
      <p>3. URI para obtener datos sobre el cohete Falcon Heavy:</p>
      <label><input type="radio" name="q3" value="a"> a) POST /rockets/falcon-heavy</label>
      <label><input type="radio" name="q3" value="b"> b) GET /falcon-heavy</label>
      <label><input type="radio" name="q3" value="c"> c) GET /rockets/falcon-heavy</label>
    </div>
    <div class="question">
      <p>4. M√©todo para la actualizaci√≥n completa de un recurso:</p>
      <label><input type="radio" name="q4" value="a"> a) PATCH</label>
      <label><input type="radio" name="q4" value="b"> b) POST</label>
      <label><input type="radio" name="q4" value="c"> c) PUT</label>
    </div>
    <div class="question">
      <p>5. HATEOAS en una API es:</p>
      <label><input type="radio" name="q5" value="a"> a) Un sistema de enlaces a recursos relacionados</label>
      <label><input type="radio" name="q5" value="b"> b) Un protocolo de cifrado</label>
      <label><input type="radio" name="q5" value="c"> c) Un lenguaje de consulta</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Verificar</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'c', q5: 'a' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Resultados:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pregunta ${question.slice(1)}: <span style="color:green;">¬°Correcto!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Pregunta ${question.slice(1)}: <span style="color:red;">Incorrecto.</span> Respuesta correcta: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Pregunta ${question.slice(1)}: <span style="color:orange;">Sin respuesta.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Tu resultado: ${score} de ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**üöÄ Resumen del cap√≠tulo:**

La API REST es una "arquitectura de estaci√≥n espacial" estandarizada para servicios web. Recuerda:

- Recursos = Objetos (cohetes, planetas)
- URI = Coordenadas de los objetos
- M√©todos HTTP = Comandos de control
- Versiones = Modernizaciones de la estaci√≥n

**¬°Final de la preparaci√≥n!** En el pr√≥ximo cap√≠tulo, lanzaremos una "sonda de prueba" ‚Äî aprenderemos a probar API a trav√©s de Postman.

> **üìå Pr√°ctica:**
Explora la estructura de la [API de SpaceX](https://docs.spacexdata.com/) e intenta ejecutar:

> `GET https://api.spacexdata.com/v4/launches/latest` ‚Äî ¬°observa el URI y la estructura JSON!