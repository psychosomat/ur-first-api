# **Chapter 3.2: Creating Your First API Endpoint**
**Time to learn:** 30 minutes

---

#### **1. Endpoint: A Docking Port for Data**
Imagine our API is a space station. An **Endpoint** is a specific **docking port** designed for a certain type of ship.

- Port `No. 1` â€” for cargo ships (data about planets).
- Port `No. 2` â€” for research probes (data about missions).
- Port `No. 3` â€” for passenger shuttles (data about astronauts).

Each endpoint is a unique URL that is responsible for a specific operation with a specific resource.

> ðŸ’¡ **Space Analogy:**
> `GET /spaceships` is the command "Mission Control â†’ Station: Report the list of all docked ships." This endpoint returns a collection of resources.

---

#### **2. Creating the "Space Fleet"**
Since we don't have a database yet, let's create a "simulation"â€”a simple list of spacecraft in the form of a Python dictionary.

**Open `main.py` and add this code before the `app` definition:**
```python
# main.py

# Step 1: Create a database simulation
db_spaceships = {
    1: {
        "name": "Voyager-1",
        "type": "Probe",
        "launch_year": 1977,
        "status": "Active"
    },
    2: {
        "name": "Hubble Space Telescope",
        "type": "Telescope",
        "launch_year": 1990,
        "status": "Active"
    },
    3: {
        "name": "ISS",
        "type": "Station",
        "launch_year": 1998,
        "status": "In Orbit"
    }
}

# ... app = FastAPI() code goes here
```
This is our "registry of spacecraft" that we will be working with.

---

#### **3. First Endpoint: The List of Ships**
Now let's create an endpoint that will return our entire fleet.

**Add this code to `main.py` after the `@app.get("/")` block:**
```python
# main.py

# ... code with db_spaceships, FastAPI, app, and read_root() ...

@app.get("/spaceships")
def get_spaceships():
    """
    Returns a list of all spacecraft in the registry.
    """
    return db_spaceships
```

- `@app.get("/spaceships")`: We have created a new route. Now, `GET` requests to the `/spaceships` URL will be handled by the `get_spaceships` function.
- `return db_spaceships`: FastAPI will automatically convert the Python dictionary into a valid JSON response.

---

#### **4. Checking the New Docking Port**
If your `uvicorn` server is still running with the `--reload` flag, it has already reloaded and is ready to go. If not, start it again:
```bash
uvicorn main:app --reload
```

**Step 1: Check in the browser**

Open `http://127.0.0.1:8000/spaceships` in your browser.
You should see the full list of your ships in JSON format:
```json
{
  "1": {
    "name": "Voyager-1",
    "type": "Probe",
    "launch_year": 1977,
    "status": "Active"
  },
  "2": {
    "name": "Hubble Space Telescope",
    "type": "Telescope",
    "launch_year": 1990,
    "status": "Active"
  },
  "3": {
    "name": "ISS",
    "type": "Station",
    "launch_year": 1998,
    "status": "In Orbit"
  }
}
```

**Step 2: Check in the auto-documentation**

Navigate to `http://127.0.0.1:8000/docs`. You will see that a new section for the `GET /spaceships` endpoint has appeared in the documentation. You can click "Try it out" and "Execute" to test it right from there!

---

#### **5. Endpoint with a Parameter: Data on a Specific Ship**
What if we only need data about "Voyager-1"? For this, we will create an endpoint with a **path parameter**.

**Add this code to `main.py`:**
```python
# main.py

# ... rest of the code ...

@app.get("/spaceships/{ship_id}")
def get_spaceship(ship_id: int):
    """
    Returns data about a specific spacecraft by its ID.
    """
    return db_spaceships.get(ship_id)
```

- `"/spaceships/{ship_id}"`: The curly braces `{}` tell FastAPI that `ship_id` is a variable that will be passed from the URL.
- `ship_id: int`: This is a **type hint**. FastAPI will automatically check that the passed ID is an integer. If someone requests `/spaceships/voyager`, FastAPI will return a `422 Unprocessable Entity` validation error. This is magic!

**Check:**

Open `http://127.0.0.1:8000/spaceships/2`. You should get the data only for the Hubble telescope. And if you open `http://127.0.0.1:8000/spaceships/99` â€” you will get `null`, as no such ship exists.

---

#### **Review Quiz**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. An endpoint in an API is...</p>
      <label><input type="radio" name="q1" value="a"> a) The end of the Universe</label>
      <label><input type="radio" name="q1" value="b"> b) A unique URL for a specific operation with a resource</label>
      <label><input type="radio" name="q1" value="c"> c) The name of a database</label>
    </div>
    <div class="question">
      <p>2. What does the `@app.get("/users")` decorator do?</p>
      <label><input type="radio" name="q2" value="a"> a) Creates a new user</label>
      <label><input type="radio" name="q2" value="b"> b) Binds a function to a GET request on `/users`</label>
      <label><input type="radio" name="q2" value="c"> c) Gets a list of all decorators</label>
    </div>
    <div class="question">
      <p>3. What does the notation `"/items/{item_id}"` in a path mean?</p>
      <label><input type="radio" name="q3" value="a"> a) That you need to look for a folder named `{item_id}`</label>
      <label><input type="radio" name="q3" value="b"> b) That `item_id` is a parameter that will be taken from the URL</label>
      <label><input type="radio" name="q3" value="c"> c) It is a comment that will be ignored</label>
    </div>
    <div class="question">
      <p>4. Why is the type hint `ship_id: int` needed in the function?</p>
      <label><input type="radio" name="q4" value="a"> a) To make Python run faster</label>
      <label><input type="radio" name="q4" value="b"> b) So that FastAPI automatically validates that the ID is a number</label>
      <label><input type="radio" name="q4" value="c"> c) To make the variable visible outside the function</label>
    </div>
    <div class="question">
      <p>5. If you request `/spaceships/abc` and FastAPI expects an `int`, what will happen?</p>
      <label><input type="radio" name="q5" value="a"> a) The server will crash with a 500 error</label>
      <label><input type="radio" name="q5" value="b"> b) FastAPI will return a 422 error</label>
      <label><input type="radio" name="q5" value="c"> c) FastAPI will try to convert "abc" to a number</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Check</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'b', q4: 'b', q5: 'b' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Results:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:green;">Correct!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:red;">Incorrect.</span> The correct answer is: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:orange;">No answer.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Your score: ${score} out of ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>


---

**ðŸš€ Chapter Summary:**

You have successfully created two "docking ports" on your API space station:

- ðŸ›°ï¸ One to get a list of all ships (`/spaceships`)
- ðŸ”­ A second to get data about a specific craft (`/spaceships/{ship_id}`)

You have also seen the power of FastAPI's automatic type validation, which protects your API from invalid requests.

**The navigation system is configured!** In the next chapter, we will create "blueprints" for our spacecraft using Pydantic to make our API even smarter and more reliable.

> **ðŸ“Œ Checkpoint:**

> - The `uvicorn` server is running.
> - The URL `http://127.0.0.1:8000/spaceships` returns a JSON with the list of ships.
> - The URL `http://127.0.0.1:8000/spaceships/1` returns the data for "Voyager-1".
> - The URL `http://127.0.0.1:8000/docs` shows two new endpoints.

> **âš ï¸ If you have errors:**

> - **404 Not Found:** Check that the URL is spelled correctly in the browser and in the `@app.get(...)` decorator.
> - **Code Error:** Carefully check the syntax, especially indentation in Python and commas in the dictionary.