# **Chapter 3.1: Installing FastAPI and Setting Up the Environment**
**Time to learn:** 45 minutes

---

#### **1. What is FastAPI? A Hyperdrive for APIs**
If Flask is a nimble reconnaissance probe and Django is a massive carrier ship, then **FastAPI** is a **superluminal fighter jet**.

**FastAPI** is a modern, high-performance web framework for creating APIs with Python 3.7+. Its main advantages are:

- **Speed:** One of the fastest Python frameworks, comparable to NodeJS and Go.
- **Simplicity:** Minimalist and intuitive syntax.
- **Auto-documentation:** Automatically creates interactive documentation for your API.
- **Typing:** Uses standard Python type hints for validation, autocompletion, and documentation.

> üí° **Space Analogy:**

> FastAPI is like a "hyperdrive" for your API ship. It is based on two technologies:

> - **Starlette** (the fighter's chassis) ‚Äî provides asynchronicity and top-tier performance.
> - **Pydantic** (the onboard computer) ‚Äî handles data validation and settings.

---

#### **2. Preparing the Launchpad: Virtual Environment**
Before we build our fighter jet, we need to create a **sterile assembly laboratory**. In Python, this is done using **virtual environments**.

**Why is this necessary?** To prevent the dependencies of our project (engines, navigation systems) from conflicting with other projects on your computer.

**Step 1: Create a virtual environment**
Open a terminal in your project folder (e.g., `C:\Projects\FastAPI_Fleet`) and run:

```bash
python -m venv venv
```
This command will create a `venv` folder with an isolated version of Python.

**Step 2: Activate the lab's "force field"**

- **Windows (PowerShell):**

  ```powershell
  .\venv\Scripts\Activate.ps1
  ```
  *(If you get an error, you may need to allow script execution: `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope Process`)*

- **Windows (CMD):**

  ```cmd
  .\venv\Scripts\activate.bat
  ```

- **macOS / Linux:**

  ```bash
  source venv/bin/activate
  ```
After activation, `(venv)` will appear at the beginning of your terminal prompt. This means you are inside your lab!

---

#### **3. Installing the Engine: FastAPI and Uvicorn**
Now let's install two key components:

- **fastapi:** The framework itself.
- **uvicorn:** A lightning-fast ASGI server that will "run" our engine.

Execute in the activated environment:
```bash
pip install "fastapi[all]"
```
> üí° **Why `[all]`?**
> This will install `fastapi`, `uvicorn`, and other useful packages (e.g., for WebSocket support and Jinja2) that will be useful in future missions.

**Check the installation:**
```bash
pip freeze
```
You should see `fastapi`, `pydantic`, `starlette`, `uvicorn`, and other packages in the list.

---

#### **4. First Contact: The `main.py` File**
Create a `main.py` file in the root of your project ‚Äî this will be the **central control panel** of our API.

**Add the following code to `main.py`:**
```python
from fastapi import FastAPI

# Create an instance of our API "spaceship"
app = FastAPI()

# Define the first "docking port" (endpoint)
# This is the root URL: /
@app.get("/")
def read_root():
    """
    This is the Mission Control message that everyone sees
    when they connect to the main gateway.
    """
    return {"message": "Welcome to the Space Fleet Command Center!"}
```
- `@app.get("/")`: This is a **decorator** that tells FastAPI that the `read_root` function should handle `GET` requests to the root URL (`/`).

---

#### **5. Ignition! Starting the Server**
It's time to start our hyperdrive! In the terminal (with `venv` active), run:
```bash
uvicorn main:app --reload
```
**Command breakdown:**

- `uvicorn`: We are starting the Uvicorn server.
- `main`: The `main.py` file (without the `.py`).
- `app`: The `app = FastAPI()` object created inside `main.py`.
- `--reload`: "Autopilot". The server will automatically restart every time you change the code.

**Expected output in the terminal:**
```
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [12345]
INFO:     Started server process [12346]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

---

#### **6. Communicating with Mission Control**
Your API is now online and listening on port `8000`!

**Step 1: Check in the browser**

Open `http://127.0.0.1:8000` in your browser. You should see:
```json
{
  "message": "Welcome to the Space Fleet Command Center!"
}
```

**Step 2: A glimpse into the future (auto-documentation)**

FastAPI has already created two gifts for you. Open these URLs:

- `http://127.0.0.1:8000/docs`: Interactive Swagger UI documentation.
- `http://127.0.0.1:8000/redoc`: Alternative ReDoc documentation.

You will see your first endpoint, which you can test directly from the browser!

---

#### **Review Quiz**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. FastAPI is known for its...</p>
      <label><input type="radio" name="q1" value="a"> a) Slow but reliable performance</label>
      <label><input type="radio" name="q1" value="b"> b) High performance and speed</label>
      <label><input type="radio" name="q1" value="c"> c) Integration only with Microsoft databases</label>
    </div>
    <div class="question">
      <p>2. Why do you need a virtual environment (`venv`)?</p>
      <label><input type="radio" name="q2" value="a"> a) To speed up Python</label>
      <label><input type="radio" name="q2" value="b"> b) To isolate project dependencies</label>
      <label><input type="radio" name="q2" value="c"> c) To automatically write tests</label>
    </div>
    <div class="question">
      <p>3. Which server is used to run FastAPI in this lesson?</p>
      <label><input type="radio" name="q3" value="a"> a) Apache</label>
      <label><input type="radio" name="q3" value="b"> b) Gunicorn</label>
      <label><input type="radio" name="q3" value="c"> c) Uvicorn</label>
    </div>
    <div class="question">
      <p>4. The command `uvicorn main:app --reload` means:</p>
      <label><input type="radio" name="q4" value="a"> a) Run the `app.py` file with the `main` object</label>
      <label><input type="radio" name="q4" value="b"> b) Run the `app` object from the `main.py` file and restart on changes</label>
      <label><input type="radio" name="q4" value="c"> c) Reboot the computer and start the application</label>
    </div>
    <div class="question">
      <p>5. What does the `@app.get("/")` decorator do in FastAPI?</p>
      <label><input type="radio" name="q5" value="a"> a) Gets data from the `app.py` file</label>
      <label><input type="radio" name="q5" value="b"> b) Sends a GET request to an external server</label>
      <label><input type="radio" name="q5" value="c"> c) Binds a function to a GET request on the root URL</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">Check</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'b', q5: 'c' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>Results:</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:green;">Correct!</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:red;">Incorrect.</span> The correct answer is: <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Question ${question.slice(1)}: <span style="color:orange;">No answer.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Your score: ${score} out of ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**üöÄ Chapter Summary:**

You have successfully assembled and launched the "hyperdrive" of your new API! You now have:

- üõ†Ô∏è An isolated development environment (`venv`)
- üöÄ FastAPI and the Uvicorn server installed
- üõ∞Ô∏è A running API with a single endpoint
- üìä Automatically generated documentation

**All systems are go!** In the next chapter, we will create our first full-fledged endpoint that will return a list of spacecraft.

> **üìå Checkpoint:**

> - The `(venv)` environment is active in the terminal
> - The `uvicorn` server is running without errors
> - The address `http://127.0.0.1:8000/docs` opens in the browser

> **‚ö†Ô∏è If you have errors:**

> - `command not found`: Make sure you have activated the virtual environment.
> - `Port ... is already in use`: Another program is using port 8000. Stop it or run uvicorn on a different port: `uvicorn main:app --reload --port 8001`.
> - Errors activating `venv` in PowerShell: Check the script execution policy.