# **Chapitre 1.3 : Le format JSON**
**Temps d'√©tude :** 35 minutes

---

#### **1. JSON : Le langage de la communication spatiale**
Imaginez qu'une sonde spatiale et le Centre de Contr√¥le de Mission parlent des langues diff√©rentes. Le **JSON (JavaScript Object Notation)** est un *langage de donn√©es universel*, compr√©hensible par les humains et les machines. Comme la langue internationale des astronautes !

**Propri√©t√©s principales :**

- ü™∂ L√©ger : transmission rapide m√™me avec un signal faible
- üëÄ Lisible par l'homme : la structure est visible √† l'≈ìil nu
- üîÑ Universel : pris en charge par tous les langages de programmation

> üí° **Analogie spatiale :**

> Le JSON est comme un t√©l√©gramme num√©rique avec des donn√©es sur les √©toiles. Au lieu du morse, des structures claires `{cl√©: valeur}`.

---

#### **2. Anatomie d'un message JSON**
Le JSON est constitu√© de deux types de structures :

**A. Objets (Vaisseaux spatiaux)**
```json
{
  "name": "Voyager-1",
  "launch_year": 1977,
  "is_active": true,
  "position": [-19.1, 42.7, 0.3]
}
```

**B. Tableaux (Amas stellaires)**
```json
[
  {"name": "Sirius", "magnitude": -1.46},
  {"name": "Canopus", "magnitude": -0.74},
  {"name": "Arcturus", "magnitude": -0.05}
]
```

**‚ö° R√®gles de syntaxe :**

- Cl√©s entre guillemets `" "`
- Valeurs : cha√Ænes de caract√®res, nombres, bool√©ens (`true`/`false`), `null`
- Donn√©es s√©par√©es par des virgules
- Accolades `{}` pour les objets, crochets `[]` pour les tableaux

---

#### **3. JSON vs XML : La bataille des formats**
| Param√®tre       | JSON (Satellite moderne)         | XML (Ancien t√©lescope)          |
|----------------|----------------------------------|--------------------------------|
| **Lisibilit√©** | √âlev√©e (acc√®s direct aux champs) | Faible (balises `<planet>...</planet>`) |
| **Taille**     | Compact                          | Volumineux (+30% √† la taille)    |
| **Traitement** | Rapide                           | Lent                           |
| **Exemple**    | `{"planet": "Mars"}`             | `<planet>Mars</planet>`        |

> **üî≠ Pourquoi le JSON a-t-il gagn√© dans l'espace ?**

> Les API de la NASA, SpaceX et l'ESA utilisent le JSON ‚Äî il est id√©al pour le transfert de donn√©es !

---

#### **4. Travailler avec JSON dans le code**
**Exemple Python (r√©cup√©ration de donn√©es sur la Lune) :**
```python
import requests
import json

# Nous utilisons une API r√©elle, par exemple, pour obtenir des donn√©es sur le syst√®me solaire
# de l'API OpenData du Syst√®me Solaire
try:
    response = requests.get("https://api.le-systeme-solaire.net/rest/bodies/terre")
    response.raise_for_status() # V√©rifie les erreurs HTTP (4xx, 5xx)

    planet_data = response.json()

    print(f"Nom : {planet_data['englishName']}")
    print(f"Satellites : {[moon['moon'] for moon in planet_data['moons']]}")

    # Conversion du dictionnaire Python en cha√Æne JSON pour l'enregistrement
    planet_json_str = json.dumps(planet_data, indent=2, ensure_ascii=False) # ensure_ascii=False pour le cyrillique
    print("\n--- JSON Format√© ---")
    print(planet_json_str)

except requests.exceptions.RequestException as e:
    print(f"Erreur de requ√™te : {e}")
```

**Exemple JavaScript (traitement des donn√©es du t√©lescope) :**
```javascript
const Data = `{
  "id": "terre",
  "name": "La Terre",
  "englishName": "Earth",
  "isPlanet": true,
  "moons": [
    {
      "moon": "La Lune",
      "rel": "https://api.le-systeme-solaire.net/rest/bodies/lune"
    }
  ],
  "semimajorAxis": 149598023,
  "perihelion": 147095000,
  "aphelion": 152100000,
  "eccentricity": 0.0167,
  "inclination": 0,
  "mass": {
    "massValue": 5.97237,
    "massExponent": 24
  },
  "vol": {
    "volValue": 1.08321,
    "volExponent": 12
  },
  "density": 5.5136,
  "gravity": 9.8,
  "escape": 11190,
  "meanRadius": 6371.0084,
  "equaRadius": 6378.1366,
  "polarRadius": 6356.8,
  "flattening": 0.00335,
  "dimension": "",
  "sideralOrbit": 365.256,
  "sideralRotation": 23.9345,
  "aroundPlanet": null,
  "discoveredBy": "",
  "discoveryDate": "",
  "alternativeName": "",
  "axialTilt": 23.4393,
  "avgTemp": 288,
  "mainAnomaly": 358.617,
  "argPeriapsis": 85.901,
  "longAscNode": 18.272,
  "bodyType": "Planet"
}`;

const dataObj = JSON.parse(Data);
console.log(dataObj.target);
```

---

#### **5. Validation JSON : V√©rification du "signal"**
Avant d'utiliser les donn√©es, assurez-vous que le JSON :

1. A une structure correcte (v√©rifiez les parenth√®ses !)

2. Contient les champs attendus

3. N'a pas d'erreurs de syntaxe

**Outils :**
- [JSONLint](https://jsonlint.com/) (comme un d√©tecteur de d√©bris spatiaux pour le JSON)
- Parseurs de langage int√©gr√©s (g√©n√©reront une erreur en cas de format incorrect)

> ‚ö†Ô∏è **Exemple d'erreur :**

> `{"planet": "Mars"` ‚Üí Pas d'accolade fermante !

> Solution : Utilisez toujours `json.loads()` en Python ou `JSON.parse()` en JS pour la v√©rification.

---

#### **Quiz pour le renforcement**

<style>
    #quiz-container {
        border-radius: 8px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .question {
        margin-bottom: 15px;
    }
    .question p {
        font-weight: bold;
        margin-bottom: 10px;
    }
    #quiz-container label {
        display: block;
        margin-bottom: 5px;
        cursor: pointer;
        padding: 5px;
        border-radius: 4px;
    }
    #quiz-container button {
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 16px;
        margin-top: 10px;
    }
    #quiz-container button:hover {
    }
    #quiz-results {
        margin-top: 20px;
        padding: 15px;
        border-radius: 5px;
    }
</style>

<div id="quiz-container">
  <form id="quiz-form">
    <div class="question">
      <p>1. JSON signifie...</p>
      <label><input type="radio" name="q1" value="a"> a) Java Space Object Notation</label>
      <label><input type="radio" name="q1" value="b"> b) JavaScript Object Notation</label>
      <label><input type="radio" name="q1" value="c"> c) Jupiter's Satellite Orbital Network</label>
    </div>
    <div class="question">
      <p>2. Comment un objet est-il d√©sign√© en JSON :</p>
      <label><input type="radio" name="q2" value="a"> a) ()</label>
      <label><input type="radio" name="q2" value="b"> b) {}</label>
      <label><input type="radio" name="q2" value="c"> c) []</label>
    </div>
    <div class="question">
      <p>3. Qu'est-ce qui N'est PAS une valeur valide en JSON?</p>
      <label><input type="radio" name="q3" value="a"> a) "name": "Saturn"</label>
      <label><input type="radio" name="q3" value="b"> b) "radius_km": 58232</label>
      <label><input type="radio" name="q3" value="c"> c) "has_rings": undefined</label>
    </div>
    <div class="question">
      <p>4. Pourquoi JSON est-il meilleur que XML pour les API spatiales ?</p>
      <label><input type="radio" name="q4" value="a"> a) Taille r√©duite et haute vitesse</label>
      <label><input type="radio" name="q4" value="b"> b) Prise en charge des encodages extraterrestres</label>
      <label><input type="radio" name="q4" value="c"> c) Possibilit√© de stocker des vid√©os</label>
    </div>
    <div class="question">
      <p>5. Comment convertir une cha√Æne JSON en objet Python?</p>
      <label><input type="radio" name="q5" value="a"> a) json.parse()</label>
      <label><input type="radio" name="q5" value="b"> b) json.to_object()</label>
      <label><input type="radio" name="q5" value="c"> c) json.loads()</label>
    </div>
    <button type="button" onclick="checkQuizAnswers()">V√©rifier</button>
  </form>
  <div id="quiz-results" style="display:none;"></div>
</div>

<script>
  function checkQuizAnswers() {
    const correctAnswers = { q1: 'b', q2: 'b', q3: 'c', q4: 'a', q5: 'c' };
    const form = document.getElementById('quiz-form');
    const resultsContainer = document.getElementById('quiz-results');
    let score = 0;
    let resultsHTML = '<h4>R√©sultats :</h4><ul>';

    for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
      const questionDiv = form.querySelector(`input[name="${question}"]`).closest('.question');
      const labels = questionDiv.querySelectorAll('label');
      labels.forEach(l => {
          l.style.color = 'inherit';
          l.style.fontWeight = 'normal';
          l.style.border = 'none';
      });

      const userAnswer = form.elements[question] ? form.elements[question].value : undefined;

      if (userAnswer) {
        const selectedLabel = form.querySelector(`input[name="${question}"][value="${userAnswer}"]`).parentElement;
        if (userAnswer === correctAnswer) {
          score++;
          selectedLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)} : <span style="color:green;">Correct !</span></li>`;
        } else {
          selectedLabel.style.fontWeight = 'bold';
          const correctLabel = form.querySelector(`input[name="${question}"][value="${correctAnswer}"]`).parentElement;
          correctLabel.style.fontWeight = 'bold';
          resultsHTML += `<li>Question ${question.slice(1)} : <span style="color:red;">Incorrect.</span> Bonne r√©ponse : <b>${correctAnswer.toUpperCase()}</b></li>`;
        }
      } else {
        resultsHTML += `<li>Question ${question.slice(1)} : <span style="color:orange;">Pas de r√©ponse.</span></li>`;
      }
    }

    resultsHTML += `</ul><p><b>Votre score : ${score} sur ${Object.keys(correctAnswers).length}</b></p>`;
    resultsContainer.innerHTML = resultsHTML;
    resultsContainer.style.display = 'block';
  }
</script>

---

**üöÄ R√©sum√© du chapitre :**

Le JSON est l'esp√©ranto spatial du monde des API. En connaissant sa structure, vous pourrez :

- üì° Recevoir des donn√©es de t√©lescopes et de sondes

- üîß Convertir des informations entre les syst√®mes

- üõ∞Ô∏è Sauvegarder des donn√©es scientifiques dans des fichiers

**Pr√©parez-vous √† l'amarrage !** Dans le prochain chapitre, nous explorerons l'architecture REST API ‚Äî le syst√®me de contr√¥le de la "station spatiale" de votre serveur.

> **üìå Pratique :** Rendez-vous sur [NASA Open APIs](https://api.nasa.gov/), trouvez l'API des ast√©ro√Ødes (Asteroids NeoWs) et √©tudiez la structure JSON de la r√©ponse !